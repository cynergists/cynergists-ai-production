import{j as e,b as ue,r as h,o as xe,O as he,A as ge,B as _,f as se,p as Ee,n as te,F as fe,s as W,u as ye,a as Ne,q as Me,t as qe,i as Fe,v as ke,C as pe,w as Le,l as _e,H as Oe,L as Be,S as $e}from"./app-DEGgoab9.js";import{L as ze}from"./Layout-VYmAvewg.js";import{C as be}from"./check-RkjWs7wE.js";import{I as q}from"./input-1skZDOCu.js";import{P as Ye}from"./phone-input-BuKrDZ2o.js";import{L as A}from"./label-DyCc8r5j.js";import{U as Re}from"./user-CKr1UnUQ.js";import{P as De}from"./phone-Z5dt2hUC.js";import{S as We,a as Ve,b as Ue,c as Ke,d as Je}from"./select-JGGC0Mgv.js";import{B as He}from"./building-2-ADJFy-6W.js";import{M as Ge}from"./Footer-DNlCA0zN.js";import{A as Ze}from"./AgreementSigningFlow-BmR1T_zO.js";import{u as Xe}from"./usePaymentSettings-D1nr45fD.js";import{C as H}from"./credit-card-B44tDpWx.js";import{R as Qe}from"./receipt-Cm27LPEv.js";import{C as et}from"./copy-DxpKLQzT.js";import{B as tt}from"./building-DgToFReh.js";/* empty css            */import"./eye-CBE4axyN.js";import"./zap-Dz25eU8Y.js";import"./scroll-area-fNnfEtsK.js";import"./index-CfEoTzS4.js";import"./index-BdQq_4o_.js";import"./purify.es-HRjpPm7y.js";import"./eye-off-BQVA7IgG.js";import"./mic-CtymPbZP.js";import"./send-CQx7ErL2.js";import"./index-Dn_VlTCY.js";import"./Combination-Dm0hFAPF.js";import"./index-D7gcp3at.js";import"./chevron-up-Dry_WOTS.js";import"./shield-BOYdibSh.js";import"./sun-C9REEsSQ.js";import"./checkbox-DjF_feXn.js";import"./index-CO2tXQvH.js";import"./circle-check-big-6H8F27Ov.js";const st=({currentStep:t,totalSteps:r,stepTitles:N})=>e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-500 ease-out",style:{width:`${(t-1)/(r-1)*100}%`}})}),e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-full flex justify-between",children:Array.from({length:r},(g,i)=>{const a=i+1,c=a<t,o=a===t;return e.jsx("div",{className:ue("w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold transition-all duration-300",c&&"bg-primary text-primary-foreground",o&&"bg-primary text-primary-foreground ring-4 ring-primary/30",!c&&!o&&"bg-muted text-muted-foreground border border-border"),title:N[i],children:c?e.jsx(be,{className:"h-4 w-4"}):a},a)})})]}),e.jsx("div",{className:"hidden lg:flex justify-between mt-4",children:N.map((g,i)=>{const a=i+1,c=a<t,o=a===t;return e.jsx("div",{className:ue("text-xs text-center max-w-[100px]",c||o?"text-foreground":"text-muted-foreground"),children:g},i)})})]}),rt=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),at=t=>t.replace(/\D/g,"").length>=7,nt=({data:t,onUpdate:r,onNext:N})=>{const[g,i]=h.useState({}),[a,c]=h.useState({}),o=(m,n)=>{switch(m){case"firstName":return n.trim()?null:"First name is required";case"lastName":return n.trim()?null:"Last name is required";case"email":return n.trim()?rt(n)?null:"Please enter a valid email address":"Email is required";case"phone":return n.trim()?at(n)?null:"Please enter a valid phone number":"Phone number is required";default:return null}},f=m=>{c(d=>({...d,[m]:!0}));const n=o(m,t[m]);i(d=>({...d,[m]:n||void 0}))},v=m=>{m.preventDefault();const n={};let d=!1;Object.keys(t).forEach(C=>{const S=o(C,t[C]);S&&(n[C]=S,d=!0)}),i(n),c({firstName:!0,lastName:!0,email:!0,phone:!0}),d||N()};return e.jsxs("div",{className:"card-glass p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Re,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Contact Information"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tell us how to reach you"})]})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"firstName",children:"First Name *"}),e.jsx(q,{id:"firstName",name:"given-name",type:"text",autoComplete:"given-name",value:t.firstName,onChange:m=>r({firstName:m.target.value}),onBlur:()=>f("firstName"),placeholder:"John",className:g.firstName&&a.firstName?"border-destructive":""}),g.firstName&&a.firstName&&e.jsx("p",{className:"text-sm text-destructive",children:g.firstName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(q,{id:"lastName",name:"family-name",type:"text",autoComplete:"family-name",value:t.lastName,onChange:m=>r({lastName:m.target.value}),onBlur:()=>f("lastName"),placeholder:"Smith",className:g.lastName&&a.lastName?"border-destructive":""}),g.lastName&&a.lastName&&e.jsx("p",{className:"text-sm text-destructive",children:g.lastName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),"Email Address *"]}),e.jsx(q,{id:"email",name:"email",type:"email",autoComplete:"email",value:t.email,onChange:m=>r({email:m.target.value}),onBlur:()=>f("email"),placeholder:"john@company.com",className:g.email&&a.email?"border-destructive":""}),g.email&&a.email&&e.jsx("p",{className:"text-sm text-destructive",children:g.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{htmlFor:"phone",className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4 text-muted-foreground"}),"Phone Number *"]}),e.jsx(Ye,{id:"phone",value:t.phone,onChange:m=>r({phone:m}),onBlur:()=>f("phone"),className:g.phone&&a.phone?"[&_input]:border-destructive":""}),g.phone&&a.phone&&e.jsx("p",{className:"text-sm text-destructive",children:g.phone})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(he,{type:"submit",className:"btn-primary w-full md:w-auto",children:["Continue",e.jsx(ge,{className:"ml-2 h-4 w-4"})]})})]})]})},it=[{value:"AL",label:"Alabama"},{value:"AK",label:"Alaska"},{value:"AZ",label:"Arizona"},{value:"AR",label:"Arkansas"},{value:"CA",label:"California"},{value:"CO",label:"Colorado"},{value:"CT",label:"Connecticut"},{value:"DE",label:"Delaware"},{value:"FL",label:"Florida"},{value:"GA",label:"Georgia"},{value:"HI",label:"Hawaii"},{value:"ID",label:"Idaho"},{value:"IL",label:"Illinois"},{value:"IN",label:"Indiana"},{value:"IA",label:"Iowa"},{value:"KS",label:"Kansas"},{value:"KY",label:"Kentucky"},{value:"LA",label:"Louisiana"},{value:"ME",label:"Maine"},{value:"MD",label:"Maryland"},{value:"MA",label:"Massachusetts"},{value:"MI",label:"Michigan"},{value:"MN",label:"Minnesota"},{value:"MS",label:"Mississippi"},{value:"MO",label:"Missouri"},{value:"MT",label:"Montana"},{value:"NE",label:"Nebraska"},{value:"NV",label:"Nevada"},{value:"NH",label:"New Hampshire"},{value:"NJ",label:"New Jersey"},{value:"NM",label:"New Mexico"},{value:"NY",label:"New York"},{value:"NC",label:"North Carolina"},{value:"ND",label:"North Dakota"},{value:"OH",label:"Ohio"},{value:"OK",label:"Oklahoma"},{value:"OR",label:"Oregon"},{value:"PA",label:"Pennsylvania"},{value:"RI",label:"Rhode Island"},{value:"SC",label:"South Carolina"},{value:"SD",label:"South Dakota"},{value:"TN",label:"Tennessee"},{value:"TX",label:"Texas"},{value:"UT",label:"Utah"},{value:"VT",label:"Vermont"},{value:"VA",label:"Virginia"},{value:"WA",label:"Washington"},{value:"WV",label:"West Virginia"},{value:"WI",label:"Wisconsin"},{value:"WY",label:"Wyoming"},{value:"DC",label:"District of Columbia"}],lt=({data:t,onUpdate:r,onNext:N,onBack:g})=>{const[i,a]=h.useState({}),[c,o]=h.useState({}),f=(n,d)=>{switch(n){case"jobTitle":return d.trim()?null:"Job title is required";case"companyName":return d.trim()?null:"Company name is required";case"streetAddress":return d.trim()?null:"Street address is required";case"city":return d.trim()?null:"City is required";case"state":return d?null:"State is required";case"zip":return d.trim()?/^\d{5}(-\d{4})?$/.test(d.trim())?null:"Please enter a valid ZIP code":"ZIP code is required";default:return null}},v=n=>{o(C=>({...C,[n]:!0}));const d=f(n,t[n]);a(C=>({...C,[n]:d||void 0}))},m=n=>{n.preventDefault();const d={};let C=!1;Object.keys(t).forEach(S=>{const P=f(S,t[S]);P&&(d[S]=P,C=!0)}),a(d),o({jobTitle:!0,companyName:!0,streetAddress:!0,city:!0,state:!0,zip:!0}),C||N()};return e.jsxs("div",{className:"card-glass p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(He,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Company Information"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Business details for your agreement"})]})]}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"jobTitle",children:"Your Job Title *"}),e.jsx(q,{id:"jobTitle",name:"organization-title",type:"text",autoComplete:"organization-title",value:t.jobTitle,onChange:n=>r({jobTitle:n.target.value}),onBlur:()=>v("jobTitle"),placeholder:"CEO, Founder, Director...",className:i.jobTitle&&c.jobTitle?"border-destructive":""}),i.jobTitle&&c.jobTitle&&e.jsx("p",{className:"text-sm text-destructive",children:i.jobTitle})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"companyName",children:"Company Name *"}),e.jsx(q,{id:"companyName",name:"organization",type:"text",autoComplete:"organization",value:t.companyName,onChange:n=>r({companyName:n.target.value}),onBlur:()=>v("companyName"),placeholder:"Acme Corporation",className:i.companyName&&c.companyName?"border-destructive":""}),i.companyName&&c.companyName&&e.jsx("p",{className:"text-sm text-destructive",children:i.companyName})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Company Address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"streetAddress",children:"Street Address *"}),e.jsx(q,{id:"streetAddress",name:"street-address",type:"text",autoComplete:"street-address",value:t.streetAddress,onChange:n=>r({streetAddress:n.target.value}),onBlur:()=>v("streetAddress"),placeholder:"123 Main Street, Suite 100",className:i.streetAddress&&c.streetAddress?"border-destructive":""}),i.streetAddress&&c.streetAddress&&e.jsx("p",{className:"text-sm text-destructive",children:i.streetAddress})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(A,{htmlFor:"city",children:"City *"}),e.jsx(q,{id:"city",name:"address-level2",type:"text",autoComplete:"address-level2",value:t.city,onChange:n=>r({city:n.target.value}),onBlur:()=>v("city"),placeholder:"New York",className:i.city&&c.city?"border-destructive":""}),i.city&&c.city&&e.jsx("p",{className:"text-sm text-destructive",children:i.city})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"state",children:"State *"}),e.jsxs(We,{value:t.state,onValueChange:n=>{r({state:n}),o(d=>({...d,state:!0})),a(d=>({...d,state:void 0}))},children:[e.jsx(Ve,{id:"state",className:i.state&&c.state?"border-destructive":"",children:e.jsx(Ue,{placeholder:"Select"})}),e.jsx(Ke,{children:it.map(n=>e.jsx(Je,{value:n.value,children:n.value},n.value))})]}),i.state&&c.state&&e.jsx("p",{className:"text-sm text-destructive",children:i.state})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"zip",children:"ZIP Code *"}),e.jsx(q,{id:"zip",name:"postal-code",type:"text",autoComplete:"postal-code",inputMode:"numeric",value:t.zip,onChange:n=>r({zip:n.target.value}),onBlur:()=>v("zip"),placeholder:"10001",maxLength:10,className:i.zip&&c.zip?"border-destructive":""}),i.zip&&c.zip&&e.jsx("p",{className:"text-sm text-destructive",children:i.zip})]})]})]}),e.jsxs("div",{className:"pt-4 flex flex-col-reverse md:flex-row gap-3",children:[e.jsxs(_,{type:"button",variant:"outline",onClick:g,className:"w-full md:w-auto",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsxs(he,{type:"submit",className:"btn-primary w-full md:w-auto",children:["Continue to Agreement",e.jsx(ge,{className:"ml-2 h-4 w-4"})]})]})]})]})},ot=({contactData:t,companyData:r,signatureData:N,planName:g,planPrice:i,onUpdateSignatures:a,onNext:c,onBack:o})=>{const f=`${t.firstName} ${t.lastName}`,v=r.jobTitle,m=r.companyName,n=`${r.streetAddress}, ${r.city}, ${r.state} ${r.zip}`,d=Ee(new Date),C=`${t.firstName.charAt(0)}${t.lastName.charAt(0)}`.toUpperCase(),[S,P]=h.useState(null),[O,l]=h.useState(!0);h.useEffect(()=>{(async()=>{try{const{data:j,error:I}=await W.from("document_templates").select("content").eq("document_type","msa").eq("is_active",!0).single();if(I||!j)P(p());else{let b=j.content.replace(/\{\{CLIENT_FIRST_NAME\}\}/gi,t.firstName).replace(/\{\{CLIENT_LAST_NAME\}\}/gi,t.lastName).replace(/\{\{CLIENT_NAME\}\}/gi,f).replace(/\{\{CLIENT_EMAIL\}\}/gi,t.email).replace(/\{\{CLIENT_PHONE\}\}/gi,t.phone).replace(/\{\{CLIENT_TITLE\}\}/gi,v).replace(/\{\{COMPANY_NAME\}\}/gi,m).replace(/\{\{CLIENT_COMPANY\}\}/gi,m||f).replace(/\{\{COMPANY_STREET\}\}/gi,r.streetAddress).replace(/\{\{COMPANY_CITY\}\}/gi,r.city).replace(/\{\{COMPANY_STATE\}\}/gi,r.state).replace(/\{\{COMPANY_ZIP\}\}/gi,r.zip).replace(/\{\{CLIENT_ADDRESS\}\}/gi,n).replace(/\{\{COMPANY_DISPLAY\}\}/gi,m||f).replace(/\{\{TODAYS_DATE\}\}/gi,d).replace(/\{\{DATE\}\}/gi,d).replace(/\{\{EFFECTIVE_DATE\}\}/gi,d).replace(/\{\{PLAN_NAME\}\}/gi,g).replace(/\{\{PLAN_PRICE\}\}/gi,`$${i.toLocaleString()}`);P(b)}}catch{P(p())}finally{l(!1)}})()},[f,m,v,n,d,g,i,t,r]);const p=()=>`
<h1 style="text-align: center;">CYNERGISTS MASTER SERVICES AGREEMENT</h1>

<p style="text-align: center;"><strong>Effective Date:</strong> ${d}</p>

<p>This Master Services Agreement ("Agreement") is entered into by and between <strong>Cynergists, LLC</strong>, 
a Wyoming limited liability company ("Cynergists"), and the undersigned client ("Client").</p>

<div style="background: var(--card); border: 1px solid var(--border); border-radius: 0.5rem; padding: 1rem; margin: 1rem 0;">
<p><strong>Client:</strong> ${f}</p>
<p><strong>Title:</strong> ${v}</p>
<p><strong>Company:</strong> ${m}</p>
<p><strong>Address:</strong> ${n}</p>
</div>

<p>Cynergists and Client may be referred to individually as a "Party" and collectively as the "Parties."</p>

<h2>1. Purpose and Structure</h2>
<p>This Agreement establishes the legal framework governing all services provided by Cynergists to Client. 
Specific commercial terms are defined in one or more Statements of Work ("SOWs") executed by the Parties.</p>

<h2>2. Services and Service Model</h2>
<p>Cynergists provides AI agents, managed services, operational support, automation, AI-enabled services, 
and related business services ("Services").</p>

<h2>3. Plans, Usage, and Automatic Scaling</h2>
<p>Client's service configuration is defined in the applicable SOW. If Client's usage exceeds limits, 
Client automatically transitions to the appropriate higher service level.</p>
{{CLIENT_INITIALS}}

<h2>4. Term, Commitment, and Renewal</h2>
<p>The initial service term is defined in the applicable SOW. Services automatically renew unless 
timely written notice is provided.</p>
{{CLIENT_INITIALS}}

<h2>5. Fees, Billing, and Payment</h2>
<p>All Services are billed in advance. Fees are non-refundable. Late payments accrue interest at 1.5% per month.</p>
{{CLIENT_INITIALS}}
    `.trim(),u=y=>{const j={clientSignature:y.signature,signedAt:y.signedAt,sectionInitials:y.sectionInitials};Object.entries(y.sectionInitials).forEach(([I,b],E)=>{const B=`section${E+3}Initials`;j[B]=b}),a(j),c()};return O?e.jsx("div",{className:"card-glass p-8 flex items-center justify-center min-h-[400px]",children:e.jsx(te,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"card-glass p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(fe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Master Services Agreement"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Review and sign to continue"})]})]}),e.jsx(Ze,{agreementContent:S||"",defaultInitials:C,defaultSignatureName:f,onComplete:u,onBack:o,showBackButton:!0,initialSectionInitials:N.sectionInitials||{},initialSignature:N.clientSignature})]})},R=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),ct=t=>{const N=t.replace(/\D/g,"").match(/.{1,4}/g);return N?N.join(" ").slice(0,19):""},dt=t=>{const r=t.replace(/\D/g,"");return r.length>=2?`${r.slice(0,2)}/${r.slice(2,4)}`:r},mt=()=>`${Date.now()}-${Math.random().toString(36).substring(2,15)}`,ut=({selectedMethod:t,onSelectMethod:r,planName:N,planPrice:g,billingPeriod:i,contactData:a,companyName:c,onNext:o,onBack:f,onTransactionComplete:v})=>{const{items:m,totalPrice:n,clearCart:d}=ye(),{settings:C}=Xe(),[S,P]=h.useState(!1),{toast:O}=Ne(),[l,p]=h.useState(!1),[u,y]=h.useState(null),[j,I]=h.useState(null),[b,E]=h.useState(null),[B,V]=h.useState(!1),[re,$]=h.useState(null),G=`${a.firstName} ${a.lastName}`.trim(),[ae,Ce]=h.useState(""),[ne,Se]=h.useState(""),[ie,we]=h.useState(""),[le,Ie]=h.useState(G),Z=N,k=C.paymentMode==="production";t!=="credit_card"&&r("credit_card");const oe=m.filter(s=>s.billingPeriod==="monthly"),X=m.filter(s=>s.billingPeriod==="annual"),Q=oe.reduce((s,x)=>s+x.price*x.quantity,0),ce=X.reduce((s,x)=>s+x.price*12*x.quantity,0),de=X.reduce((s,x)=>{const M=x.price/.9*.1*12*x.quantity;return s+M},0),U=ce+Q,L=X.length>0,me=oe.length>0,z=L&&me;h.useEffect(()=>{if(k&&!l){const s=document.createElement("script");return s.src="https://web.squarecdn.com/v1/square.js",s.async=!0,s.onload=()=>p(!0),document.body.appendChild(s),()=>{document.body.contains(s)&&document.body.removeChild(s)}}},[k,l]),h.useEffect(()=>{k&&(!j||!b)&&fetch("undefined/functions/v1/process-square-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"get-location"})}).then(s=>s.json()).then(s=>{console.log("Square config received:",{locationId:s.locationId,applicationId:s.applicationId,paymentMode:s.paymentMode}),s.locationId&&I(s.locationId),s.applicationId&&E(s.applicationId),s.error&&(console.error("Error fetching Square config:",s.error),$(s.error))}).catch(s=>{console.error("Failed to fetch Square config:",s),$("Failed to connect to payment service")})},[k,j,b]),h.useEffect(()=>{let s=!0,x=null;const F=async()=>{if(!k||!l||!window.Square||!j||!b)return;if(!document.getElementById("square-card-container")){setTimeout(()=>{s&&F()},100);return}V(!0),$(null);try{if(u){try{u.destroy()}catch(Pe){console.warn("Error destroying previous Square card:",Pe)}y(null)}console.log("Initializing Square payments with:",{applicationId:b,locationId:j});const w=await window.Square.payments(b,j);if(!s)return;const ee={input:{backgroundColor:"transparent",color:"hsl(var(--foreground))",fontFamily:"inherit",fontSize:"14px"},"input::placeholder":{color:"hsl(var(--muted-foreground))"},"input.is-focus":{backgroundColor:"transparent"},".input-container":{borderColor:"hsl(var(--border))",borderWidth:"1px",borderRadius:"6px"},".input-container.is-focus":{borderColor:"hsl(var(--primary))",borderWidth:"1px"},".input-container.is-error":{borderColor:"hsl(var(--destructive))",borderWidth:"1px"},".message-text":{color:"hsl(var(--muted-foreground))"},".message-icon":{color:"hsl(var(--muted-foreground))"},".message-text.is-error":{color:"hsl(var(--destructive))"},".message-icon.is-error":{color:"hsl(var(--destructive))"}},T=await w.card({style:ee});if(!s){T.destroy();return}if(x=T,!document.getElementById("square-card-container")){T.destroy();return}if(await T.attach("#square-card-container"),!s){T.destroy();return}y(T),$(null),console.log("Square card initialized successfully")}catch(w){console.error("Failed to initialize Square card:",w),s&&$(w instanceof Error?w.message:"An unexpected error occurred while initializing the payment method")}finally{s&&V(!1)}},M=setTimeout(F,50);return()=>{if(s=!1,clearTimeout(M),x)try{x.destroy()}catch(Y){console.warn("Error destroying Square card on cleanup:",Y)}}},[k,l,j,b]),h.useEffect(()=>()=>{if(u)try{u.destroy()}catch(s){console.warn("Error destroying Square card on unmount:",s)}},[u]);const Te=async s=>{s.preventDefault(),P(!0);try{let x;if(k){if(!u)throw new Error("Payment form not properly initialized. Please refresh and try again.");const w=await u.tokenize();if(w.status!=="OK"||!w.token)throw new Error(w.errors?.[0]?.message||"Card tokenization failed. Please check your card details.");x=w.token}else x="cnon:card-nonce-ok";const F=m.map(w=>({name:w.name,description:w.description,quantity:w.quantity,price:Math.round(w.price*100)})),{data:M,error:Y}=await W.functions.invoke("process-square-payment",{body:{sourceId:x,amount:Math.round(U*100),currency:"USD",customerEmail:a.email,customerName:G,planName:Z,billingPeriod:z?"mixed":L?"annual":"monthly",monthlyPrice:Math.round(Q*100),idempotencyKey:mt(),paymentType:"card",cartItems:F,processingFee:0}});if(Y)throw new Error(Y.message||"Payment processing failed");if(M?.success){const w={subscriptionId:M?.subscriptionId,customerId:M?.customerId,amountPaid:U,processingFee:0,paymentMethod:t,billingPeriod:z?"mixed":L?"annual":"monthly",paidAt:new Date,cartItems:m.map(T=>({name:T.name,description:T.description,quantity:T.quantity,price:T.price,billingPeriod:T.billingPeriod}))};v(w);const ee=C.paymentMode==="sandbox";W.functions.invoke("send-checkout-confirmation",{body:{customerEmail:a.email,customerName:G,planName:Z,billingPeriod:z?"mixed":L?"annual":"monthly",amountPaid:Math.round(U*100),cartItems:F,paymentMethod:t,processingFee:0,companyName:c||void 0,transactionId:M?.subscriptionId||M?.transactionId,isTestMode:ee}}).catch(T=>console.error("Failed to send confirmation email:",T)),d(),O({title:"Payment Successful",description:`Your ${Z} plan subscription is now active.`}),o()}else throw new Error(M?.error||"Payment failed")}catch(x){const F=x instanceof Error?x.message:"There was an error processing your payment. Please try again.";O({title:"Payment Failed",description:F,variant:"destructive"})}finally{P(!1)}},Ae=k?u!==null&&!B:(()=>{const s=ae.replace(/\s/g,""),x=ne.split("/");return s.length===16&&x.length===2&&x[0].length===2&&x[1].length===2&&ie.length>=3&&le.trim().length>0})();return e.jsxs("div",{className:"card-glass p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(H,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Payment"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your card details to complete purchase"})]})]}),e.jsxs("div",{className:"bg-primary/10 border border-primary/30 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"font-semibold text-foreground mb-2",children:["Your Order"," ",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",z?"mixed billing":L?"annual billing":"monthly recurring",")"]})]}),e.jsx("div",{className:"space-y-1 mb-3",children:m.map(s=>{const x=s.billingPeriod==="annual",F=x?s.price*12*s.quantity:s.price*s.quantity,M=x?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.name," ",s.quantity>1&&`x${s.quantity}`,x&&e.jsx("span",{className:"text-xs ml-1 text-primary",children:"(Annual)"})]}),e.jsxs("span",{className:"text-foreground",children:[R(F),M]})]},s.id)})})]}),e.jsxs("div",{className:"space-y-2 border-t border-primary/20 pt-3",children:[me&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Monthly items (billed monthly)"}),e.jsxs("span",{className:"text-foreground",children:[R(Q),"/mo"]})]}),L&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Annual items (billed yearly)"}),e.jsxs("span",{className:"text-foreground",children:[R(ce),"/yr"]})]}),de>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-green-400",children:"Annual savings (10% discount)"}),e.jsx("span",{className:"text-green-400",children:R(Math.round(de))})]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-primary/20",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Due today"}),e.jsx("span",{className:"text-2xl font-bold text-primary",children:R(U)})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-right",children:z?"Annual items paid upfront â€¢ Monthly items billed monthly":L?"Billed annually":"Billed monthly"})]})]}),e.jsxs("form",{onSubmit:Te,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(H,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium text-foreground",children:"Credit Card Details"})]}),k?e.jsxs("div",{className:"space-y-4",children:[re&&e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive/30 rounded-lg text-destructive text-sm",children:re}),B&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(te,{className:"h-4 w-4 animate-spin"}),"Initializing payment form..."]}),e.jsx("div",{id:"square-card-container",className:"min-h-[120px] border border-border rounded-lg p-4 bg-background"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"cardName",children:"Cardholder Name"}),e.jsx(q,{id:"cardName",name:"ccname",type:"text",autoComplete:"cc-name",value:le,onChange:s=>Ie(s.target.value),placeholder:"John Smith",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"cardNumber",children:"Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{id:"cardNumber",name:"cardnumber",type:"text",autoComplete:"cc-number",inputMode:"numeric",value:ae,onChange:s=>Ce(ct(s.target.value)),placeholder:"4242 4242 4242 4242",maxLength:19,required:!0}),e.jsx(H,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"expiry",children:"Expiration Date"}),e.jsx(q,{id:"expiry",name:"cc-exp",type:"text",autoComplete:"cc-exp",inputMode:"numeric",value:ne,onChange:s=>Se(dt(s.target.value)),placeholder:"MM/YY",maxLength:5,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"cvv",children:"CVV"}),e.jsx(q,{id:"cvv",name:"cvc",type:"text",autoComplete:"cc-csc",inputMode:"numeric",value:ie,onChange:s=>we(s.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"123",maxLength:4,required:!0})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-card/50 border border-border/50 rounded-lg",children:[e.jsx(Me,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Secure Payment"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your payment information is encrypted and securely processed"})]})]}),e.jsxs("div",{className:"pt-4 flex flex-col-reverse md:flex-row gap-3",children:[e.jsxs(_,{type:"button",variant:"outline",onClick:f,disabled:S,className:"w-full md:w-auto",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsx(_,{type:"submit",className:"btn-primary w-full md:w-auto",disabled:!Ae||S,children:S?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"mr-2 h-4 w-4"}),"Purchase"]})})]})]})]})},K=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),pt=t=>new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"short"}).format(t),xt=({checkoutData:t,transactionData:r})=>{const{toast:N}=Ne();t.planName.charAt(0).toUpperCase()+t.planName.slice(1);const g=(a,c)=>{navigator.clipboard.writeText(a),N({title:"Copied!",description:`${c} copied to clipboard`})},i=()=>{if(!r)return"Monthly Recurring";switch(r.billingPeriod){case"annual":return"Annual Billing";case"mixed":return"Mixed Billing (Monthly & Annual)";default:return"Monthly Recurring"}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"card-glass p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-primary/20 mb-6 animate-pulse",children:e.jsx(be,{className:"h-10 w-10 text-primary"})}),e.jsx("h2",{className:"font-display text-3xl font-bold text-foreground mb-4",children:"Payment Successful!"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Thank you for choosing Cynergists. Your subscription is now active."}),e.jsxs("div",{className:"inline-flex items-center gap-3 bg-primary/10 border border-primary/30 rounded-lg px-6 py-3",children:[e.jsx(xe,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{className:"text-sm text-foreground",children:["Confirmation sent to ",e.jsx("strong",{children:t.contact.email})]})]})]}),e.jsxs("div",{className:"card-glass p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"font-display font-bold text-lg text-foreground flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-primary"}),"Transaction Receipt"]}),r?.paidAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Fe,{className:"h-4 w-4"}),pt(new Date(r.paidAt))]})]}),r?.subscriptionId&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Transaction ID"}),e.jsx("p",{className:"font-mono text-sm text-foreground",children:r.subscriptionId})]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>g(r.subscriptionId,"Transaction ID"),children:e.jsx(et,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Order Items"}),r?.cartItems?.map((a,c)=>{const o=a.billingPeriod==="annual",f=o?a.price*12*a.quantity:a.price*a.quantity,v=o?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between py-2 border-b border-border last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-foreground",children:a.name}),a.quantity>1&&e.jsxs("span",{className:"text-muted-foreground ml-1",children:["x",a.quantity]}),a.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.description}),o&&e.jsx("span",{className:"inline-block text-xs bg-primary/20 text-primary px-2 py-0.5 rounded mt-1",children:"Annual"})]}),e.jsxs("span",{className:"text-foreground font-medium",children:[K(f),v]})]},c)})]}),e.jsxs("div",{className:"border-t border-border pt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{className:"text-foreground",children:K((r?.amountPaid||t.planPrice)-(r?.processingFee||0))})]}),r?.processingFee&&r.processingFee>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Processing Fee"}),e.jsx("span",{className:"text-foreground",children:K(r.processingFee)})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-border",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Total Paid"}),e.jsx("span",{className:"text-xl font-bold text-primary",children:K(r?.amountPaid||t.planPrice)})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Payment Method"}),e.jsx("div",{className:"flex items-center gap-2 text-foreground",children:(r?.paymentMethod||t.paymentMethod)==="ach"?e.jsxs(e.Fragment,{children:[e.jsx(tt,{className:"h-4 w-4"}),"ACH Bank Transfer"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4"}),"Credit Card"]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Billing Cycle"}),e.jsx("p",{className:"text-foreground",children:i()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Customer"}),e.jsxs("p",{className:"text-foreground",children:[t.contact.firstName," ",t.contact.lastName]})]}),t.company.companyName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Company"}),e.jsx("p",{className:"text-foreground",children:t.company.companyName})]})]})]}),e.jsx("div",{className:"bg-destructive/10 border border-destructive/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(ke,{className:"h-6 w-6 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display font-bold text-lg text-foreground mb-2",children:"Important: Service Activation"}),e.jsxs("p",{className:"text-foreground mb-4",children:["Your service will ",e.jsx("strong",{children:"not begin"})," until you complete your onboarding call. Scheduling your onboarding is ",e.jsx("strong",{children:"required"})," to activate your subscription."]})]})]})}),e.jsxs("div",{className:"card-glass p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(pe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-xl font-bold text-foreground",children:"Final Step: Schedule Your Onboarding Call"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This is required to start your services"})]})]}),e.jsxs("div",{className:"bg-background/50 border border-border rounded-lg p-8 min-h-[400px] flex flex-col items-center justify-center",children:[e.jsx(pe,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium text-foreground mb-2",children:"Onboarding Calendar"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center max-w-md mb-6",children:"Calendar embed will be configured here. Select a time that works best for your 30-minute onboarding call."}),e.jsxs("div",{className:"text-center text-xs text-muted-foreground bg-muted/50 rounded p-4",children:[e.jsx("p",{className:"font-medium mb-1",children:"Calendar Integration Pending"}),e.jsx("p",{children:"The calendar embed will be added once you provide the scheduling tool details."})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Can't find a time that works?"," ",e.jsx(_,{variant:"link",className:"text-primary p-0 h-auto",asChild:!0,children:e.jsx("a",{href:"mailto:support@cynergists.com",children:"Contact us directly"})})]})})]}),e.jsxs("div",{className:"card-glass p-6",children:[e.jsx("h3",{className:"font-display font-bold text-lg text-foreground mb-4",children:"What Happens Next?"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary text-primary-foreground text-sm font-bold flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Schedule Your Onboarding"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pick a time above to meet with your dedicated account manager"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground text-sm font-bold flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Complete Onboarding Call"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"We'll discuss your priorities, set up communication channels, and assign your team"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground text-sm font-bold flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Start Working Together"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your services begin immediately after onboarding is complete"})]})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs(_,{variant:"outline",onClick:()=>window.print(),className:"gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Print Receipt"]})})]})},J=["Contact Information","Company Information","Review & Sign Agreement","Payment","Confirmation"],je="cynergists_checkout_contact",ve="cynergists_checkout_company",ht=()=>{try{const t=localStorage.getItem(je);if(t)return JSON.parse(t)}catch(t){console.error("Error loading stored contact info:",t)}return{firstName:"",lastName:"",email:"",phone:""}},gt=()=>{try{const t=localStorage.getItem(ve);if(t)return JSON.parse(t)}catch(t){console.error("Error loading stored company info:",t)}return{jobTitle:"",companyName:"",streetAddress:"",city:"",state:"",zip:""}},ft={sectionInitials:{},section3Initials:"",section4Initials:"",section5Initials:"",section6Initials:"",section7Initials:"",clientSignature:"",signedAt:null},D=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),rs=()=>{const{url:t}=Le();new URLSearchParams(t.split("?")[1]??"");const{items:r,totalPrice:N,totalItems:g}=ye(),[i,a]=h.useState(1),c=r.map(l=>`${l.name}${l.quantity>1?` x${l.quantity}`:""}`).join(", "),[o,f]=h.useState(()=>({contact:ht(),company:gt(),signatures:ft,paymentMethod:null,planName:c||"Custom Order",planPrice:N,billingPeriod:"monthly"}));h.useEffect(()=>{f(l=>({...l,planName:c||"Custom Order",planPrice:N}))},[N,c]),h.useEffect(()=>{(async()=>{const{data:{user:p}}=await W.auth.getUser();if(!p)return;const{data:u}=await W.from("profiles").select("first_name, last_name, email, phone, company_name, title").eq("user_id",p.id).single();if(u){const y={firstName:u.first_name||"",lastName:u.last_name||"",email:u.email||p.email||"",phone:u.phone||""},j={companyName:u.company_name||"",jobTitle:u.title||""};f(I=>({...I,contact:{...I.contact,firstName:y.firstName||I.contact.firstName,lastName:y.lastName||I.contact.lastName,email:y.email||I.contact.email,phone:y.phone||I.contact.phone},company:{...I.company,companyName:j.companyName||I.company.companyName,jobTitle:j.jobTitle||I.company.jobTitle}}))}})()},[]),h.useEffect(()=>{r.length===0&&_e.visit("/cart")},[r.length]);const v=l=>{f(p=>{const u={...p.contact,...l};try{localStorage.setItem(je,JSON.stringify(u))}catch(y){console.error("Error saving contact info:",y)}return{...p,contact:u}})},m=l=>{f(p=>{const u={...p.company,...l};try{localStorage.setItem(ve,JSON.stringify(u))}catch(y){console.error("Error saving company info:",y)}return{...p,company:u}})},n=l=>{f(p=>({...p,signatures:{...p.signatures,...l}}))},d=l=>{f(p=>({...p,paymentMethod:l}))},C=l=>{f(p=>({...p,transaction:l}))},S=()=>{i<5&&(a(l=>l+1),window.scrollTo({top:0,behavior:"smooth"}))},P=()=>{i>1&&(a(l=>l-1),window.scrollTo({top:0,behavior:"smooth"}))},O=()=>{switch(i){case 1:return e.jsx(nt,{data:o.contact,onUpdate:v,onNext:S});case 2:return e.jsx(lt,{data:o.company,onUpdate:m,onNext:S,onBack:P});case 3:return e.jsx(ot,{contactData:o.contact,companyData:o.company,signatureData:o.signatures,planName:o.planName,planPrice:o.planPrice,onUpdateSignatures:n,onNext:S,onBack:P});case 4:return e.jsx(ut,{selectedMethod:o.paymentMethod,onSelectMethod:d,planName:o.planName,planPrice:o.planPrice,billingPeriod:o.billingPeriod,contactData:o.contact,companyName:o.company.companyName,onNext:S,onBack:P,onTransactionComplete:C});case 5:return e.jsx(xt,{checkoutData:o,transactionData:o.transaction});default:return null}};return e.jsxs(ze,{children:[e.jsxs(Oe,{children:[e.jsx("title",{children:"Checkout | Cynergists"}),e.jsx("meta",{name:"description",content:"Complete your Cynergists subscription setup securely."}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsx("main",{className:"min-h-screen py-12 lg:py-20",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(_,{variant:"ghost",asChild:!0,className:"mb-6",children:e.jsxs(Be,{href:"/cart",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Back to Cart"]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"font-display text-3xl md:text-4xl font-bold text-foreground mb-4",children:"Checkout"}),e.jsxs("div",{className:"card-glass p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx($e,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"Your Order"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",g," ",g===1?"item":"items",")"]})]}),e.jsx("div",{className:"space-y-2",children:r.map(l=>{const p=l.billingPeriod==="annual",u=p?l.price*12*l.quantity:l.price*l.quantity,y=p?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[l.name," ",l.quantity>1&&`x${l.quantity}`,e.jsxs("span",{className:"text-xs ml-2",children:["(",l.description,")"]}),p&&e.jsx("span",{className:"text-xs ml-1 text-primary",children:"(Annual)"})]}),e.jsxs("span",{className:"font-medium",children:[D(u),y]})]},l.id)})}),(()=>{const l=r.filter(b=>b.billingPeriod==="monthly"),p=r.filter(b=>b.billingPeriod==="annual"),u=l.reduce((b,E)=>b+E.price*E.quantity,0),y=p.reduce((b,E)=>b+E.price*12*E.quantity,0),j=p.reduce((b,E)=>{const V=E.price/.9*.1*12*E.quantity;return b+V},0),I=y+u;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-border mt-3 pt-3 space-y-2",children:[u>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Monthly Items (billed monthly)"}),e.jsxs("span",{className:"font-medium",children:[D(u),"/mo"]})]}),y>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Annual Items (billed yearly)"}),e.jsxs("span",{className:"font-medium",children:[D(y),"/yr"]})]}),j>0&&e.jsxs("div",{className:"flex justify-between text-sm text-primary",children:[e.jsx("span",{children:"Annual Savings"}),e.jsx("span",{className:"font-medium",children:D(Math.round(j))})]})]}),e.jsx("div",{className:"border-t-2 border-primary mt-3 pt-3",children:e.jsx("div",{className:"bg-primary/10 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-bold text-foreground",children:"Due Today"}),u>0&&y>0&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Includes 1 month of monthly items + annual items"})]}),e.jsx("span",{className:"text-2xl font-bold text-primary",children:D(I)})]})})})]})})()]}),e.jsxs("p",{className:"text-muted-foreground",children:["Step ",i," of ",J.length,": ",J[i-1]]})]}),e.jsxs("div",{className:"sticky top-16 z-20 bg-background pb-4 -mx-4 px-4 border-b border-border/50 shadow-sm",children:[e.jsx(st,{currentStep:i,totalSteps:J.length,stepTitles:J}),e.jsx("div",{className:"mt-6",children:O()})]})]})})})]})};export{rs as default};
