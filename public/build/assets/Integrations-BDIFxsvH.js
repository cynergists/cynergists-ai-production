import{as as T,r as j,u as S,j as e,L as q,B as r,d as k,P as A,T as E,h as n,s as g}from"./app-C9sJHYCL.js";import{u as f}from"./useMutation-Dhp3buk0.js";import{I as v}from"./input-BIyZmrfA.js";import{L as l}from"./label-CON6LZW3.js";import{T as L}from"./textarea-Ho9uOiBu.js";import{S as M}from"./switch-CgUnYb0N.js";import{T as P,a as Q,b as u,c as h,d as z,e as o}from"./table-DvSgZRYl.js";import{D as K,g as B,a as G,c as H,d as O,e as R,f as U}from"./dialog-DAfnVAW3.js";import{P as Y}from"./pencil-Z_c4sc1N.js";/* empty css            */import"./index-B3oBxWiH.js";import"./index-H_9W4N8N.js";import"./index-qTvOvuVq.js";import"./Combination-Bv4OtcuM.js";function ce(){const m=T(),[b,x]=j.useState(!1),[c,y]=j.useState(null),[a,i]=j.useState({name:"",description:"",icon:"plug",category:"General",is_active:!0}),{data:p,isLoading:F}=S({queryKey:["portal-integrations"],queryFn:async()=>{const{data:s,error:t}=await g.from("portal_integrations").select("*").order("sort_order",{ascending:!0});if(t)throw t;return s}}),N=f({mutationFn:async s=>{const{error:t}=await g.from("portal_integrations").insert({...s,sort_order:(p?.length||0)+1});if(t)throw t},onSuccess:()=>{m.invalidateQueries({queryKey:["portal-integrations"]}),n.success("Integration created successfully"),d()},onError:s=>{n.error("Failed to create integration: "+s.message)}}),C=f({mutationFn:async({id:s,data:t})=>{const{error:w}=await g.from("portal_integrations").update(t).eq("id",s);if(w)throw w},onSuccess:()=>{m.invalidateQueries({queryKey:["portal-integrations"]}),n.success("Integration updated successfully"),d()},onError:s=>{n.error("Failed to update integration: "+s.message)}}),_=f({mutationFn:async s=>{const{error:t}=await g.from("portal_integrations").delete().eq("id",s);if(t)throw t},onSuccess:()=>{m.invalidateQueries({queryKey:["portal-integrations"]}),n.success("Integration deleted successfully")},onError:s=>{n.error("Failed to delete integration: "+s.message)}}),d=()=>{i({name:"",description:"",icon:"plug",category:"General",is_active:!0}),y(null),x(!1)},D=s=>{y(s),i({name:s.name,description:s.description||"",icon:s.icon||"plug",category:s.category||"General",is_active:s.is_active}),x(!0)},I=s=>{s.preventDefault(),c?C.mutate({id:c.id,data:a}):N.mutate(a)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(q,{href:"/admin/client-portal",children:e.jsx(r,{variant:"ghost",size:"icon",children:e.jsx(k,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Manage Integrations"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure integrations available to customers"})]})]}),e.jsxs(K,{open:b,onOpenChange:x,children:[e.jsx(B,{asChild:!0,children:e.jsxs(r,{onClick:()=>d(),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Add Integration"]})}),e.jsx(G,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:I,children:[e.jsxs(H,{children:[e.jsx(O,{children:c?"Edit Integration":"Add Integration"}),e.jsx(R,{children:c?"Update the integration details":"Fill in the details for the new integration"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(v,{id:"name",value:a.name,onChange:s=>i({...a,name:s.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(L,{id:"description",value:a.description,onChange:s=>i({...a,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"icon",children:"Icon"}),e.jsx(v,{id:"icon",value:a.icon,onChange:s=>i({...a,icon:s.target.value}),placeholder:"e.g., plug, zap"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"category",children:"Category"}),e.jsx(v,{id:"category",value:a.category,onChange:s=>i({...a,category:s.target.value})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{id:"is_active",checked:a.is_active,onCheckedChange:s=>i({...a,is_active:s})}),e.jsx(l,{htmlFor:"is_active",children:"Active"})]})]}),e.jsxs(U,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(r,{type:"submit",disabled:N.isPending||C.isPending,children:c?"Update":"Create"})]})]})})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(P,{children:[e.jsx(Q,{children:e.jsxs(u,{children:[e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Category"}),e.jsx(h,{children:"Active"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsx(z,{children:F?e.jsx(u,{children:e.jsx(o,{colSpan:4,className:"text-center",children:"Loading..."})}):p?.length===0?e.jsx(u,{children:e.jsx(o,{colSpan:4,className:"text-center text-muted-foreground",children:'No integrations yet. Click "Add Integration" to create one.'})}):p?.map(s=>e.jsxs(u,{children:[e.jsx(o,{className:"font-medium",children:s.name}),e.jsx(o,{children:s.category||"-"}),e.jsx(o,{children:s.is_active?"Yes":"No"}),e.jsxs(o,{className:"text-right",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>D(s),children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>{confirm("Are you sure you want to delete this integration?")&&_.mutate(s.id)},children:e.jsx(E,{className:"h-4 w-4"})})]})]},s.id))})]})})]})}export{ce as default};
