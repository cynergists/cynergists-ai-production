import{w as A,r as f,u as E,j as e,L as P,B as l,d as q,P as R,T as k,h as n,s as h,e as L}from"./app-C0WycfZe.js";import{u as y}from"./useMutation-HYWZGZXg.js";import{I as p}from"./input-B1mdCLd5.js";import{L as o}from"./label-BqY6sEFX.js";import{T as M}from"./textarea-HgaMdGFR.js";import{S as Q}from"./switch-weRXBmuD.js";import{T as B,a as K,b as g,c,d as O,e as i}from"./table-D6JhU9yR.js";import{D as z,g as H,a as U,c as V,d as Y,e as $,f as G}from"./dialog-BrdWhXwW.js";import{S as J,a as W,b as X,c as Z,d as ee}from"./select-DQRCPwkF.js";import{P as se}from"./pencil-vfihWKu3.js";/* empty css            */import"./index-B-RSaXN7.js";import"./index-CuknWpgH.js";import"./index-Cch_8Clv.js";import"./Combination-COh087cd.js";import"./index-BdQq_4o_.js";import"./index-CQc07GE5.js";import"./check-43nAdBq2.js";import"./chevron-up-DGGjGr1B.js";const S=[{value:"in_progress",label:"In Progress",color:"bg-orange-500"},{value:"coming_soon",label:"Coming Soon",color:"bg-green-500"},{value:"planned",label:"Planned",color:"bg-gray-500"}];function Ne(){const x=A(),[_,j]=f.useState(!1),[d,N]=f.useState(null),[a,r]=f.useState({title:"",description:"",status:"planned",eta:"",category:"",progress:0,is_active:!0}),{data:v,isLoading:w}=E({queryKey:["portal-roadmap"],queryFn:async()=>{const{data:s,error:t}=await h.from("portal_roadmap_items").select("*").order("sort_order",{ascending:!0});if(t)throw t;return s}}),b=y({mutationFn:async s=>{const{error:t}=await h.from("portal_roadmap_items").insert({...s,sort_order:(v?.length||0)+1});if(t)throw t},onSuccess:()=>{x.invalidateQueries({queryKey:["portal-roadmap"]}),n.success("Roadmap item created successfully"),m()},onError:s=>{n.error("Failed to create item: "+s.message)}}),C=y({mutationFn:async({id:s,data:t})=>{const{error:u}=await h.from("portal_roadmap_items").update(t).eq("id",s);if(u)throw u},onSuccess:()=>{x.invalidateQueries({queryKey:["portal-roadmap"]}),n.success("Roadmap item updated successfully"),m()},onError:s=>{n.error("Failed to update item: "+s.message)}}),F=y({mutationFn:async s=>{const{error:t}=await h.from("portal_roadmap_items").delete().eq("id",s);if(t)throw t},onSuccess:()=>{x.invalidateQueries({queryKey:["portal-roadmap"]}),n.success("Roadmap item deleted successfully")},onError:s=>{n.error("Failed to delete item: "+s.message)}}),m=()=>{r({title:"",description:"",status:"planned",eta:"",category:"",progress:0,is_active:!0}),N(null),j(!1)},T=s=>{N(s),r({title:s.title,description:s.description||"",status:s.status,eta:s.eta||"",category:s.category||"",progress:s.progress||0,is_active:s.is_active}),j(!0)},D=s=>{s.preventDefault(),d?C.mutate({id:d.id,data:a}):b.mutate(a)},I=s=>{const t=S.find(u=>u.value===s);return e.jsx(L,{className:`${t?.color} text-white`,children:t?.label||s})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(P,{href:"/admin/client-portal",children:e.jsx(l,{variant:"ghost",size:"icon",children:e.jsx(q,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Manage Roadmap"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure roadmap items visible to customers"})]})]}),e.jsxs(z,{open:_,onOpenChange:j,children:[e.jsx(H,{asChild:!0,children:e.jsxs(l,{onClick:()=>m(),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Item"]})}),e.jsx(U,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:D,children:[e.jsxs(V,{children:[e.jsx(Y,{children:d?"Edit Roadmap Item":"Add Roadmap Item"}),e.jsx($,{children:d?"Update the roadmap item details":"Fill in the details for the new roadmap item"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"title",children:"Title"}),e.jsx(p,{id:"title",value:a.title,onChange:s=>r({...a,title:s.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx(M,{id:"description",value:a.description,onChange:s=>r({...a,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"status",children:"Status"}),e.jsxs(J,{value:a.status,onValueChange:s=>r({...a,status:s}),children:[e.jsx(W,{children:e.jsx(X,{})}),e.jsx(Z,{children:S.map(s=>e.jsx(ee,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"eta",children:"ETA"}),e.jsx(p,{id:"eta",value:a.eta,onChange:s=>r({...a,eta:s.target.value}),placeholder:"e.g., Q2 2026"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"category",children:"Category"}),e.jsx(p,{id:"category",value:a.category,onChange:s=>r({...a,category:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"progress",children:"Progress (%)"}),e.jsx(p,{id:"progress",type:"number",min:"0",max:"100",value:a.progress,onChange:s=>r({...a,progress:parseInt(s.target.value)||0})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{id:"is_active",checked:a.is_active,onCheckedChange:s=>r({...a,is_active:s})}),e.jsx(o,{htmlFor:"is_active",children:"Active"})]})]}),e.jsxs(G,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:m,children:"Cancel"}),e.jsx(l,{type:"submit",disabled:b.isPending||C.isPending,children:d?"Update":"Create"})]})]})})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(B,{children:[e.jsx(K,{children:e.jsxs(g,{children:[e.jsx(c,{children:"Title"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"ETA"}),e.jsx(c,{children:"Progress"}),e.jsx(c,{children:"Active"}),e.jsx(c,{className:"text-right",children:"Actions"})]})}),e.jsx(O,{children:w?e.jsx(g,{children:e.jsx(i,{colSpan:6,className:"text-center",children:"Loading..."})}):v?.length===0?e.jsx(g,{children:e.jsx(i,{colSpan:6,className:"text-center text-muted-foreground",children:'No roadmap items yet. Click "Add Item" to create one.'})}):v?.map(s=>e.jsxs(g,{children:[e.jsx(i,{className:"font-medium",children:s.title}),e.jsx(i,{children:I(s.status)}),e.jsx(i,{children:s.eta||"-"}),e.jsxs(i,{children:[s.progress||0,"%"]}),e.jsx(i,{children:s.is_active?"Yes":"No"}),e.jsxs(i,{className:"text-right",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>T(s),children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>{confirm("Are you sure you want to delete this item?")&&F.mutate(s.id)},children:e.jsx(k,{className:"h-4 w-4"})})]})]},s.id))})]})})]})}export{Ne as default};
