import{au as T,r as j,d as S,j as e,L as k,B as r,f as q,P as A,T as E,k as n,s as g}from"./app-CjsYDFmT.js";import{u as f}from"./useMutation-BrlSJFFx.js";import{I as v}from"./input-BBc2sdOt.js";import{L as l}from"./label-Dvt0WIie.js";import{T as L}from"./textarea-DjNE0yWa.js";import{S as M}from"./switch-BMqUTsNK.js";import{T as P,a as Q,b as u,c as h,d as z,e as o}from"./table-eclqq7yM.js";import{D as K,g as B,a as G,c as H,d as O,e as R,f as U}from"./dialog-vfH9N2qe.js";import{P as Y}from"./pencil-Bba5Q9sV.js";/* empty css            */import"./index-CSw9D2VK.js";import"./index-BSKaJvun.js";import"./index-58Jk2LJy.js";import"./Combination-Mg1W9W58.js";function ce(){const m=T(),[b,x]=j.useState(!1),[c,y]=j.useState(null),[s,i]=j.useState({name:"",description:"",icon:"plug",category:"General",is_active:!0}),{data:p,isLoading:F}=S({queryKey:["portal-integrations"],queryFn:async()=>{const{data:a,error:t}=await g.from("portal_integrations").select("*").order("sort_order",{ascending:!0});if(t)throw t;return a}}),N=f({mutationFn:async a=>{const{error:t}=await g.from("portal_integrations").insert({...a,sort_order:(p?.length||0)+1});if(t)throw t},onSuccess:()=>{m.invalidateQueries({queryKey:["portal-integrations"]}),n.success("Integration created successfully"),d()},onError:a=>{n.error("Failed to create integration: "+a.message)}}),C=f({mutationFn:async({id:a,data:t})=>{const{error:w}=await g.from("portal_integrations").update(t).eq("id",a);if(w)throw w},onSuccess:()=>{m.invalidateQueries({queryKey:["portal-integrations"]}),n.success("Integration updated successfully"),d()},onError:a=>{n.error("Failed to update integration: "+a.message)}}),_=f({mutationFn:async a=>{const{error:t}=await g.from("portal_integrations").delete().eq("id",a);if(t)throw t},onSuccess:()=>{m.invalidateQueries({queryKey:["portal-integrations"]}),n.success("Integration deleted successfully")},onError:a=>{n.error("Failed to delete integration: "+a.message)}}),d=()=>{i({name:"",description:"",icon:"plug",category:"General",is_active:!0}),y(null),x(!1)},D=a=>{y(a),i({name:a.name,description:a.description||"",icon:a.icon||"plug",category:a.category||"General",is_active:a.is_active}),x(!0)},I=a=>{a.preventDefault(),c?C.mutate({id:c.id,data:s}):N.mutate(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{href:"/admin/client-portal",children:e.jsx(r,{variant:"ghost",size:"icon",children:e.jsx(q,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Manage Integrations"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure integrations available to customers"})]})]}),e.jsxs(K,{open:b,onOpenChange:x,children:[e.jsx(B,{asChild:!0,children:e.jsxs(r,{onClick:()=>d(),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Add Integration"]})}),e.jsx(G,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:I,children:[e.jsxs(H,{children:[e.jsx(O,{children:c?"Edit Integration":"Add Integration"}),e.jsx(R,{children:c?"Update the integration details":"Fill in the details for the new integration"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(v,{id:"name",value:s.name,onChange:a=>i({...s,name:a.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(L,{id:"description",value:s.description,onChange:a=>i({...s,description:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"icon",children:"Icon"}),e.jsx(v,{id:"icon",value:s.icon,onChange:a=>i({...s,icon:a.target.value}),placeholder:"e.g., plug, zap"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"category",children:"Category"}),e.jsx(v,{id:"category",value:s.category,onChange:a=>i({...s,category:a.target.value})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{id:"is_active",checked:s.is_active,onCheckedChange:a=>i({...s,is_active:a})}),e.jsx(l,{htmlFor:"is_active",children:"Active"})]})]}),e.jsxs(U,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(r,{type:"submit",disabled:N.isPending||C.isPending,children:c?"Update":"Create"})]})]})})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(P,{children:[e.jsx(Q,{children:e.jsxs(u,{children:[e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Category"}),e.jsx(h,{children:"Active"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsx(z,{children:F?e.jsx(u,{children:e.jsx(o,{colSpan:4,className:"text-center",children:"Loading..."})}):p?.length===0?e.jsx(u,{children:e.jsx(o,{colSpan:4,className:"text-center text-muted-foreground",children:'No integrations yet. Click "Add Integration" to create one.'})}):p?.map(a=>e.jsxs(u,{children:[e.jsx(o,{className:"font-medium",children:a.name}),e.jsx(o,{children:a.category||"-"}),e.jsx(o,{children:a.is_active?"Yes":"No"}),e.jsxs(o,{className:"text-right",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>D(a),children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>{confirm("Are you sure you want to delete this integration?")&&_.mutate(a.id)},children:e.jsx(E,{className:"h-4 w-4"})})]})]},a.id))})]})})]})}export{ce as default};
