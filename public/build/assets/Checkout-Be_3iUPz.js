import{l as je,r,j as e,m as R,B as v,n as Q,o as Me,p as Le,h as A,q as Oe,g as Be,t as $e,C as he,F as Re,v as ze,w as Ue,i as Ye,H as De,L as Ve,d as We,S as Je}from"./app-Lw9toWEL.js";import{I as N}from"./input-yF94Vncd.js";import{L as b}from"./label-BmZ0klfu.js";import{u as He}from"./usePaymentSettings-DDoVt54a.js";import{U as Ke}from"./user-B6g2DlSq.js";import{C as ge}from"./circle-check-CUaUGkCj.js";import{C as G}from"./credit-card-pJcqw7N1.js";import{C as Qe}from"./check-DtvS8aN0.js";import{R as Ge}from"./receipt-CXZQHeCO.js";import{C as Xe}from"./copy-joC8m2D-.js";import{B as Ze}from"./building-ICyNChQA.js";import{L as es}from"./Layout-DZ9UC0KG.js";/* empty css            */import"./index-Bewwc68W.js";import"./Footer-CZruhjoG.js";import"./sparkles-Bc8uZx6o.js";import"./shield-CRohBmyg.js";import"./sun-CPjJFBpN.js";import"./phone-YxvPiuip.js";import"./eye-COYcjsCX.js";import"./zap-DvOn9d_I.js";import"./scroll-area-QxNMFOlD.js";import"./index-DVcw4AEI.js";import"./index-BdQq_4o_.js";import"./purify.es-HRjpPm7y.js";import"./eye-off-CwyeFkCS.js";import"./mic-Bjx0u0u_.js";import"./send-4vHz585h.js";const K=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),ss=t=>{const u=t.replace(/\D/g,"").match(/.{1,4}/g);return u?u.join(" ").slice(0,19):""},ts=t=>{const n=t.replace(/\D/g,"");return n.length>=2?`${n.slice(0,2)}/${n.slice(2,4)}`:n},rs=()=>`${Date.now()}-${Math.random().toString(36).substring(2,15)}`,fe=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),as=({onNext:t,onTransactionComplete:n,user:u})=>{const{items:f,clearCart:_}=je(),{settings:i}=He(),y=r.useRef(null),[o,p]=r.useState("checking"),[x,z]=r.useState(""),[S,c]=r.useState(""),[h,M]=r.useState(""),[P,V]=r.useState(""),[g,I]=r.useState(""),[X,Z]=r.useState(!1),[ee,se]=r.useState(!1),[L,te]=r.useState(null),[m,F]=r.useState({}),[re,ae]=r.useState(!1),[U,Ne]=r.useState(!1),[q,ne]=r.useState(null),[O,be]=r.useState(null),[B,ve]=r.useState(null),[ie,oe]=r.useState(!1),[le,$]=r.useState(null),[ce,we]=r.useState(""),[de,Ce]=r.useState(""),[me,Se]=r.useState(""),[W,J]=r.useState(""),j=i.paymentMode==="production",ue=f.filter(s=>s.billingPeriod==="monthly"),xe=f.filter(s=>s.billingPeriod==="annual"),Pe=ue.reduce((s,a)=>s+a.price*a.quantity,0),Y=xe.reduce((s,a)=>s+a.price*12*a.quantity,0)+Pe,H=xe.length>0,Ie=ue.length>0,pe=H&&Ie,qe=f.map(s=>`${s.name}${s.quantity>1?` x${s.quantity}`:""}`).join(", ");r.useEffect(()=>{u?(te({name:u.name,email:u.email}),z(u.email),p("logged_in"),J(u.name||"")):p("enter_email")},[u]),r.useEffect(()=>{if(j&&!U){const s=document.createElement("script");return s.src="https://web.squarecdn.com/v1/square.js",s.async=!0,s.onload=()=>Ne(!0),document.body.appendChild(s),()=>{document.body.contains(s)&&document.body.removeChild(s)}}},[j,U]),r.useEffect(()=>{j&&(!O||!B)&&fetch("/api/payment/config",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then(s=>s.json()).then(s=>{s.locationId&&be(s.locationId),s.applicationId&&ve(s.applicationId),s.error&&$(s.error)}).catch(s=>{console.error("Failed to fetch Square config:",s),$("Failed to connect to payment service")})},[j,O,B]),r.useEffect(()=>{let s=!0,a=null;const d=async()=>{if(!j||!U||!window.Square||!O||!B)return;if(!document.getElementById("square-card-container")){setTimeout(()=>{s&&d()},100);return}oe(!0),$(null);try{if(q){try{q.destroy()}catch(_e){console.warn("Error destroying previous Square card:",_e)}ne(null)}const C=await window.Square.payments(B,O);if(!s)return;const E={input:{backgroundColor:"transparent",color:"hsl(var(--foreground))",fontFamily:"inherit",fontSize:"14px"},"input::placeholder":{color:"hsl(var(--muted-foreground))"},".input-container":{borderColor:"hsl(var(--border))",borderWidth:"1px",borderRadius:"6px"},".input-container.is-focus":{borderColor:"hsl(var(--primary))"},".input-container.is-error":{borderColor:"hsl(var(--destructive))"}},l=await C.card({style:E});if(!s){l.destroy();return}if(a=l,!document.getElementById("square-card-container")){l.destroy();return}if(await l.attach("#square-card-container"),!s){l.destroy();return}ne(l),$(null)}catch(C){console.error("Failed to initialize Square card:",C),s&&$(C instanceof Error?C.message:"Failed to initialize payment")}finally{s&&oe(!1)}},w=setTimeout(d,50);return()=>{if(s=!1,clearTimeout(w),a)try{a.destroy()}catch(k){console.warn("Error destroying Square card on cleanup:",k)}}},[j,U,O,B]),r.useEffect(()=>{y.current=q},[q]),r.useEffect(()=>()=>{if(y.current)try{y.current.destroy()}catch(s){console.warn("Error destroying Square card on unmount:",s)}},[]);const ke=async()=>{if(!fe(x)){F({email:"Please enter a valid email address"});return}Z(!0),F({});try{(await(await fetch("/api/checkout/check-email",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({email:x})})).json()).exists?p("existing_user"):p("new_user")}catch(s){console.error("Error checking email:",s),A.error("Failed to check email. Please try again.")}finally{Z(!1)}},Fe=async()=>{const s={};if(S.trim()||(s.firstName="First name is required"),h.trim()||(s.lastName="Last name is required"),fe(x)||(s.email="Valid email is required"),P.length<8&&(s.password="Password must be at least 8 characters"),P!==g&&(s.confirmPassword="Passwords do not match"),Object.keys(s).length>0){F(s);return}se(!0),F({});try{const a=await fetch("/api/checkout/register",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({first_name:S,last_name:h,email:x,password:P,password_confirmation:g})}),d=await a.json();if(a.ok&&d.success)te({name:d.user.name,email:d.user.email}),J(`${S} ${h}`),p("logged_in"),A.success("Account created successfully!");else if(d.errors){const w={};Object.keys(d.errors).forEach(k=>{w[k]=d.errors[k][0]}),F(w)}else A.error(d.message||"Failed to create account")}catch(a){console.error("Error registering:",a),A.error("Failed to create account. Please try again.")}finally{se(!1)}},Ee=async s=>{s.preventDefault(),ae(!0);try{let a;if(j){if(!q)throw new Error("Payment form not properly initialized. Please refresh and try again.");const l=await q.tokenize();if(l.status!=="OK"||!l.token)throw new Error(l.errors?.[0]?.message||"Card tokenization failed.");a=l.token}else a="cnon:card-nonce-ok";const d=f.map(l=>({name:l.name,description:l.description,quantity:l.quantity,price:Math.round(l.price*100)})),w=L?.email||x,k=L?.name||`${S} ${h}`.trim()||W,C=await fetch("/api/payment/process",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({source_id:a,amount:Math.round(Y*100),currency:"USD",customer_email:w,customer_name:k,idempotency_key:rs(),order_description:qe||"Custom Order",cart_items:d})}),E=await C.json();if(!C.ok)throw new Error(E.error||"Payment processing failed");if(E.success){const l={subscriptionId:E.payment_id,customerId:void 0,amountPaid:Y,processingFee:0,paymentMethod:"credit_card",billingPeriod:pe?"mixed":H?"annual":"monthly",paidAt:new Date,cartItems:f.map(T=>({name:T.name,description:T.description,quantity:T.quantity,price:T.price,billingPeriod:T.billingPeriod}))};n(l),_(),A.success("Payment successful!"),t()}else throw new Error(E.error||"Payment failed")}catch(a){const d=a instanceof Error?a.message:"Payment failed. Please try again.";A.error(d)}finally{ae(!1)}},Te=j?q!==null&&!ie:(()=>{const s=ce.replace(/\s/g,""),a=de.split("/");return s.length===16&&a.length===2&&a[0].length===2&&a[1].length===2&&me.length>=3&&W.trim().length>0})(),Ae=(o==="logged_in"||o==="existing_user")&&Te&&!re;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-glass p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Ke,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o==="checking"?"Checking your login status...":o==="logged_in"?"You're signed in and ready to checkout":o==="existing_user"?"Welcome back!":"Enter your email to continue"})]})]}),o==="checking"&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/30 border border-border rounded-lg",children:[e.jsx(R,{className:"h-5 w-5 text-muted-foreground animate-spin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Verifying your account..."})]}),o==="logged_in"&&L&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-primary/5 border border-primary/20 rounded-lg",children:[e.jsx(ge,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:L.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:L.email})]})]}),o==="existing_user"&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-primary/5 border border-primary/20 rounded-lg",children:[e.jsx(ge,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:"Welcome back!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x})]}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",className:"text-xs",onClick:()=>p("enter_email"),children:"Change"})]}),o==="enter_email"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(b,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{id:"email",type:"email",value:x,onChange:s=>{z(s.target.value),F({})},placeholder:"you@example.com",className:m.email?"border-destructive":""}),e.jsx(v,{type:"button",onClick:ke,disabled:X||!x,children:X?e.jsx(R,{className:"h-4 w-4 animate-spin"}):"Continue"})]}),m.email&&e.jsx("p",{className:"text-sm text-destructive",children:m.email})]})}),o==="new_user"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-primary/5 border border-primary/20 rounded-lg",children:[e.jsx(Q,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm text-foreground",children:x}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",className:"ml-auto text-xs",onClick:()=>p("enter_email"),children:"Change"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"firstName",children:"First Name"}),e.jsx(N,{id:"firstName",value:S,onChange:s=>c(s.target.value),placeholder:"John",className:m.firstName?"border-destructive":""}),m.firstName&&e.jsx("p",{className:"text-sm text-destructive",children:m.firstName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"lastName",children:"Last Name"}),e.jsx(N,{id:"lastName",value:h,onChange:s=>M(s.target.value),placeholder:"Smith",className:m.lastName?"border-destructive":""}),m.lastName&&e.jsx("p",{className:"text-sm text-destructive",children:m.lastName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"password",children:"Password"}),e.jsx(N,{id:"password",type:"password",value:P,onChange:s=>V(s.target.value),placeholder:"Minimum 8 characters",className:m.password?"border-destructive":""}),m.password&&e.jsx("p",{className:"text-sm text-destructive",children:m.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(N,{id:"confirmPassword",type:"password",value:g,onChange:s=>I(s.target.value),placeholder:"Confirm your password",className:m.confirmPassword?"border-destructive":""}),m.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive",children:m.confirmPassword})]}),e.jsx(v,{type:"button",onClick:Fe,disabled:ee,className:"w-full",children:ee?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):"Create Account & Continue"})]})]}),(o==="logged_in"||o==="existing_user")&&e.jsxs("div",{className:"card-glass p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(G,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Payment"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your card details"})]})]}),e.jsxs("div",{className:"bg-primary/10 border border-primary/30 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"font-semibold text-foreground mb-2",children:"Your Order"}),e.jsx("div",{className:"space-y-1",children:f.map(s=>{const a=s.billingPeriod==="annual",d=a?s.price*12*s.quantity:s.price*s.quantity,w=a?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.name," ",s.quantity>1&&`x${s.quantity}`]}),e.jsxs("span",{className:"text-foreground",children:[K(d),w]})]},s.id)})})]}),e.jsxs("div",{className:"border-t border-primary/20 pt-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Due today"}),e.jsx("span",{className:"text-2xl font-bold text-primary",children:K(Y)})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-right mt-1",children:pe?"Annual items paid upfront â€¢ Monthly items billed monthly":H?"Billed annually":"Billed monthly"})]})]}),e.jsxs("form",{onSubmit:Ee,className:"space-y-6",children:[j?e.jsxs("div",{className:"space-y-4",children:[le&&e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive/30 rounded-lg text-destructive text-sm",children:le}),ie&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(R,{className:"h-4 w-4 animate-spin"}),"Initializing payment form..."]}),e.jsx("div",{id:"square-card-container",className:"min-h-[120px] border border-border rounded-lg p-4 bg-background"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"cardName",children:"Cardholder Name"}),e.jsx(N,{id:"cardName",type:"text",value:W,onChange:s=>J(s.target.value),placeholder:"John Smith",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"cardNumber",children:"Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{id:"cardNumber",type:"text",inputMode:"numeric",value:ce,onChange:s=>we(ss(s.target.value)),placeholder:"4242 4242 4242 4242",maxLength:19,required:!0}),e.jsx(G,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"expiry",children:"Expiration"}),e.jsx(N,{id:"expiry",type:"text",inputMode:"numeric",value:de,onChange:s=>Ce(ts(s.target.value)),placeholder:"MM/YY",maxLength:5,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"cvv",children:"CVV"}),e.jsx(N,{id:"cvv",type:"text",inputMode:"numeric",value:me,onChange:s=>Se(s.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"123",maxLength:4,required:!0})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-card/50 border border-border/50 rounded-lg",children:[e.jsx(Me,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Secure Payment"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your payment information is encrypted and securely processed"})]})]}),e.jsx(v,{type:"submit",className:"btn-primary w-full",disabled:!Ae,children:re?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"mr-2 h-4 w-4"}),"Complete Purchase - ",K(Y)]})})]})]})]})},D=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),ns=t=>new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"short"}).format(t),is=({checkoutData:t,transactionData:n})=>{const{toast:u}=Oe();t.planName.charAt(0).toUpperCase()+t.planName.slice(1);const f=(i,y)=>{navigator.clipboard.writeText(i),u({title:"Copied!",description:`${y} copied to clipboard`})},_=()=>{if(!n)return"Monthly Recurring";switch(n.billingPeriod){case"annual":return"Annual Billing";case"mixed":return"Mixed Billing (Monthly & Annual)";default:return"Monthly Recurring"}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"card-glass p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-primary/20 mb-6 animate-pulse",children:e.jsx(Qe,{className:"h-10 w-10 text-primary"})}),e.jsx("h2",{className:"font-display text-3xl font-bold text-foreground mb-4",children:"Payment Successful!"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Thank you for choosing Cynergists. Your subscription is now active."}),e.jsxs("div",{className:"inline-flex items-center gap-3 bg-primary/10 border border-primary/30 rounded-lg px-6 py-3",children:[e.jsx(Q,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{className:"text-sm text-foreground",children:["Confirmation sent to ",e.jsx("strong",{children:t.contact.email})]})]})]}),e.jsxs("div",{className:"card-glass p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"font-display font-bold text-lg text-foreground flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5 text-primary"}),"Transaction Receipt"]}),n?.paidAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Be,{className:"h-4 w-4"}),ns(new Date(n.paidAt))]})]}),n?.subscriptionId&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Transaction ID"}),e.jsx("p",{className:"font-mono text-sm text-foreground",children:n.subscriptionId})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>f(n.subscriptionId,"Transaction ID"),children:e.jsx(Xe,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Order Items"}),n?.cartItems?.map((i,y)=>{const o=i.billingPeriod==="annual",p=o?i.price*12*i.quantity:i.price*i.quantity,x=o?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between py-2 border-b border-border last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-foreground",children:i.name}),i.quantity>1&&e.jsxs("span",{className:"text-muted-foreground ml-1",children:["x",i.quantity]}),i.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:i.description}),o&&e.jsx("span",{className:"inline-block text-xs bg-primary/20 text-primary px-2 py-0.5 rounded mt-1",children:"Annual"})]}),e.jsxs("span",{className:"text-foreground font-medium",children:[D(p),x]})]},y)})]}),e.jsxs("div",{className:"border-t border-border pt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{className:"text-foreground",children:D((n?.amountPaid||t.planPrice)-(n?.processingFee||0))})]}),n?.processingFee&&n.processingFee>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Processing Fee"}),e.jsx("span",{className:"text-foreground",children:D(n.processingFee)})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-border",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Total Paid"}),e.jsx("span",{className:"text-xl font-bold text-primary",children:D(n?.amountPaid||t.planPrice)})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Payment Method"}),e.jsx("div",{className:"flex items-center gap-2 text-foreground",children:(n?.paymentMethod||t.paymentMethod)==="ach"?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"h-4 w-4"}),"ACH Bank Transfer"]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4"}),"Credit Card"]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Billing Cycle"}),e.jsx("p",{className:"text-foreground",children:_()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Customer"}),e.jsxs("p",{className:"text-foreground",children:[t.contact.firstName," ",t.contact.lastName]})]}),t.company.companyName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Company"}),e.jsx("p",{className:"text-foreground",children:t.company.companyName})]})]})]}),e.jsx("div",{className:"bg-destructive/10 border border-destructive/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx($e,{className:"h-6 w-6 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display font-bold text-lg text-foreground mb-2",children:"Important: Service Activation"}),e.jsxs("p",{className:"text-foreground mb-4",children:["Your service will ",e.jsx("strong",{children:"not begin"})," until you complete your onboarding call. Scheduling your onboarding is ",e.jsx("strong",{children:"required"})," to activate your subscription."]})]})]})}),e.jsxs("div",{className:"card-glass p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(he,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-xl font-bold text-foreground",children:"Final Step: Schedule Your Onboarding Call"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This is required to start your services"})]})]}),e.jsxs("div",{className:"bg-background/50 border border-border rounded-lg p-8 min-h-[400px] flex flex-col items-center justify-center",children:[e.jsx(he,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium text-foreground mb-2",children:"Onboarding Calendar"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center max-w-md mb-6",children:"Calendar embed will be configured here. Select a time that works best for your 30-minute onboarding call."}),e.jsxs("div",{className:"text-center text-xs text-muted-foreground bg-muted/50 rounded p-4",children:[e.jsx("p",{className:"font-medium mb-1",children:"Calendar Integration Pending"}),e.jsx("p",{children:"The calendar embed will be added once you provide the scheduling tool details."})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Can't find a time that works?"," ",e.jsx(v,{variant:"link",className:"text-primary p-0 h-auto",asChild:!0,children:e.jsx("a",{href:"mailto:support@cynergists.com",children:"Contact us directly"})})]})})]}),e.jsxs("div",{className:"card-glass p-6",children:[e.jsx("h3",{className:"font-display font-bold text-lg text-foreground mb-4",children:"What Happens Next?"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary text-primary-foreground text-sm font-bold flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Schedule Your Onboarding"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pick a time above to meet with your dedicated account manager"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground text-sm font-bold flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Complete Onboarding Call"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"We'll discuss your priorities, set up communication channels, and assign your team"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground text-sm font-bold flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Start Working Together"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your services begin immediately after onboarding is complete"})]})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs(v,{variant:"outline",onClick:()=>window.print(),className:"gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Print Receipt"]})})]})},ye=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),Os=()=>{const{items:t,totalPrice:n,totalItems:u}=je(),{props:f}=ze(),_=Ue(),[i,y]=r.useState("billing"),[o,p]=r.useState();r.useEffect(()=>{t.length===0&&i!=="confirmation"&&Ye.visit("/cart")},[t.length,i]);const x=c=>{p(c),_.removeQueries({queryKey:["portal-agents"]})},z=()=>{y("confirmation"),window.scrollTo({top:0,behavior:"smooth"})},S={contact:{firstName:"",lastName:"",email:"",phone:""},company:{jobTitle:"",companyName:"",streetAddress:"",city:"",state:"",zip:""},signatures:{sectionInitials:{},clientSignature:"",signedAt:null},paymentMethod:"credit_card",planName:t.map(c=>c.name).join(", ")||"Custom Order",planPrice:n,billingPeriod:"monthly",transaction:o};return e.jsxs(es,{children:[e.jsxs(De,{children:[e.jsx("title",{children:"Checkout | Cynergists"}),e.jsx("meta",{name:"description",content:"Complete your Cynergists subscription setup securely."}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsx("main",{className:"min-h-screen py-12 lg:py-20",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[i==="billing"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"ghost",asChild:!0,className:"mb-6",children:e.jsxs(Ve,{href:"/cart",children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),"Back to Cart"]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"font-display text-3xl md:text-4xl font-bold text-foreground mb-4",children:"Checkout"}),e.jsxs("div",{className:"card-glass p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Je,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"Your Order"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",u," ",u===1?"item":"items",")"]})]}),e.jsx("div",{className:"space-y-2",children:t.map(c=>{const h=c.billingPeriod==="annual",M=h?c.price*12*c.quantity:c.price*c.quantity,P=h?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[c.name," ",c.quantity>1&&`x${c.quantity}`,h&&e.jsx("span",{className:"text-xs ml-1 text-primary",children:"(Annual)"})]}),e.jsxs("span",{className:"font-medium",children:[ye(M),P]})]},c.id)})}),(()=>{const c=t.filter(g=>g.billingPeriod==="monthly"),h=t.filter(g=>g.billingPeriod==="annual"),M=c.reduce((g,I)=>g+I.price*I.quantity,0),V=h.reduce((g,I)=>g+I.price*12*I.quantity,0)+M;return e.jsx("div",{className:"border-t border-border mt-3 pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold",children:"Due Today"}),e.jsx("span",{className:"text-xl font-bold text-primary",children:ye(V)})]})})})()]})]}),e.jsx(as,{onNext:z,onTransactionComplete:x,user:f.auth?.user})]}),i==="confirmation"&&e.jsx(is,{checkoutData:S,transactionData:o})]})})})]})};export{Os as default};
