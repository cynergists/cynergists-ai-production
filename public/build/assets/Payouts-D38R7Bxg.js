import{j as e,a as b,X as A,B as T,L as B,A as L,ba as R,r as p,s as E,p as H,e as v,g as N,K as c,C as I,R as U,aN as V,t as F}from"./app-yl1YHj2k.js";import{C as j,b as f,c as y,d as X,a as g}from"./card-Dxx2nlaR.js";import{T as $,a as q,b as w,c as i,d as K,e as o}from"./table-Digz5nhl.js";import{S as W}from"./skeleton-CoYTk_MQ.js";import{C as Y}from"./check-3ows1Yys.js";import{C as z}from"./credit-card-CfrH8oNf.js";import{C as P}from"./circle-check-CXfnWLUV.js";import{C}from"./circle-x-DTVS6-d-.js";/* empty css            */function G({items:s,showCTA:l=!0}){const d=s.filter(t=>!t.completed),m=d[0];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:s.map((t,x)=>e.jsxs("div",{className:b("flex items-center gap-3 p-3 rounded-lg border",t.completed?"bg-green-500/10 border-green-500/20":"bg-muted/50 border-border"),children:[e.jsx("div",{className:b("flex items-center justify-center w-6 h-6 rounded-full",t.completed?"bg-green-500 text-white":"bg-muted-foreground/20 text-muted-foreground"),children:t.completed?e.jsx(Y,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"})}),e.jsx("span",{className:b("text-sm",t.completed?"text-green-600 dark:text-green-400":"text-foreground"),children:t.label})]},x))}),l&&d.length>0&&e.jsx(T,{asChild:!0,className:"w-full",children:e.jsxs(B,{href:`/partner/settings${m?.anchor?`#${m.anchor}`:""}`,children:["Complete activation steps",e.jsx(L,{className:"ml-2 h-4 w-4"})]})})]})}const J={scheduled:{label:"Scheduled",variant:"secondary",icon:N},ready:{label:"Ready",variant:"default",icon:F},processing:{label:"Processing",variant:"outline",icon:N},paid:{label:"Paid",variant:"default",icon:P},failed:{label:"Failed",variant:"destructive",icon:C},canceled:{label:"Canceled",variant:"outline",icon:C}};function ce(){const{partner:s,status:l}=R(),[d,m]=p.useState([]),[t,x]=p.useState(!0),[n,M]=p.useState(null);p.useEffect(()=>{l==="active"&&s?.id?D():x(!1)},[s?.id,l]);const D=async()=>{try{const{data:a,error:r}=await E.from("partner_payouts").select("id, batch_date, total_amount, commission_count, status, paid_at").eq("partner_id",s.id).order("batch_date",{ascending:!1});if(r)throw r;const u=(a||[]).map(h=>({...h,payout_date:h.payout_date||null}));m(u);const S=u.find(h=>["scheduled","ready"].includes(h.status));M(S||null)}catch(a){console.error("Error fetching payouts:",a)}finally{x(!1)}},_=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),k=a=>{const r=J[a]||{label:a,variant:"outline",icon:N},u=r.icon;return e.jsxs(v,{variant:r.variant,className:"gap-1",children:[e.jsx(u,{className:"h-3 w-3"}),r.label]})};return l!=="active"?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Payouts"}),e.jsxs(j,{className:"max-w-2xl",children:[e.jsxs(f,{children:[e.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(H,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx(y,{className:"text-center",children:"Payouts Locked"}),e.jsx(X,{className:"text-center",children:"Complete the activation checklist to access payout management."})]}),e.jsx(g,{children:e.jsx(G,{items:[]})})]})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Payouts"}),e.jsx("p",{className:"text-muted-foreground",children:"View your payout method and payout history."}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Payout Method"]})}),e.jsxs(g,{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.payout_provider==="manual"?"Manual Transfer":"Direct Deposit"}),s.payout_last4&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Account ending in ",s.payout_last4]}),s.payout_status==="verified"?e.jsxs(v,{variant:"default",className:"mt-2 gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"Verified"]}):e.jsxs(v,{variant:"secondary",className:"mt-2 gap-1",children:[e.jsx(N,{className:"h-3 w-3"}),"Pending Verification"]})]})}),s.pending_payout_last4&&s.payout_change_active_after&&e.jsxs("div",{className:"mt-4 p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-amber-600",children:"Pending Payout Method Change"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["New account ending in ",s.pending_payout_last4," will be active after"," ",c(new Date(s.payout_change_active_after),"MMM d, yyyy 'at' h:mm a")]}),!s.payout_change_confirmed&&e.jsx("p",{className:"text-sm text-amber-600 mt-1",children:"⚠️ Please confirm via email link"})]})]})]}),n&&e.jsxs(j,{className:"border-primary/20 bg-primary/5",children:[e.jsx(f,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"Upcoming Payout"]})}),e.jsx(g,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Amount"}),e.jsx("p",{className:"text-2xl font-bold",children:_(n.total_amount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Commissions"}),e.jsx("p",{className:"text-2xl font-bold",children:n.commission_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payout Date"}),e.jsx("p",{className:"text-2xl font-bold",children:n.payout_date?c(new Date(n.payout_date),"MMM d"):c(new Date(n.batch_date),"MMM d")})]})]})})]}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Payout History"]})}),e.jsx(g,{className:"p-0",children:t?e.jsx("div",{className:"p-6 space-y-4",children:[...Array(3)].map((a,r)=>e.jsx(W,{className:"h-12 w-full"},r))}):d.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(V,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No payouts yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your first payout will appear here after commissions are earned and processed."})]}):e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(w,{children:[e.jsx(i,{children:"Payout Date"}),e.jsx(i,{children:"Amount"}),e.jsx(i,{children:"Commissions"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Paid At"})]})}),e.jsx(K,{children:d.map(a=>e.jsxs(w,{children:[e.jsx(o,{children:a.payout_date?c(new Date(a.payout_date),"MMM d, yyyy"):c(new Date(a.batch_date),"MMM d, yyyy")}),e.jsx(o,{className:"font-medium",children:_(a.total_amount)}),e.jsx(o,{children:a.commission_count}),e.jsx(o,{children:k(a.status)}),e.jsx(o,{children:a.paid_at?c(new Date(a.paid_at),"MMM d, yyyy"):"-"})]},a.id))})]})})]})]})}export{ce as default};
