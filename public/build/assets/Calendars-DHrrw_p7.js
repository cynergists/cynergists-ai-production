import{c as ue,j as e,C as te,r as m,B as _,T as he,e as se,z as Fe,h as w,aA as Pe,K as ce,m as me,u as xe,w as X,f as oe,H as De,E as Te,P as Ee,X as Ae}from"./app-yl1YHj2k.js";import{I as g}from"./input-B3tD5KH9.js";import{L as x}from"./label-C79MsPnt.js";import{P as Oe,a as Re,b as Ie}from"./popover-DDEgPh1u.js";import{P as Ue,a as He,b as K,c as Me,d as $e,e as ze}from"./pagination-CPFb1XRs.js";import{S as A,a as O,b as R,c as I,d as f}from"./select-bZyWIIk8.js";import{C as Ge}from"./card-Dxx2nlaR.js";import{C as pe}from"./check-3ows1Yys.js";import{C as ge}from"./copy-CIQGldNx.js";import{E as ve}from"./external-link-CTFkYG5W.js";import{C as qe}from"./chevron-up-CP4UIDax.js";import{S as We,a as Ve,b as Be,c as Qe}from"./sheet-C4rCJEIN.js";import{T as $}from"./textarea-CY5CbXPo.js";import{S as B}from"./separator-BjCLCjV4.js";import{u as Xe}from"./useAutoSave-CnxF731O.js";import{I as Ye}from"./info-Oa8sZutY.js";import{D as Je,a as Ze,c as Ke,d as ea}from"./dialog-B01Lxjmp.js";import{u as z}from"./useMutation-Dt0Tk2fE.js";import{c as G}from"./admin-api-G7yaMq_z.js";import{u as aa}from"./useDebounce-Ad3TQppg.js";import{F as ta}from"./filter-DvbsL620.js";/* empty css            */import"./index-ClWG0nRm.js";import"./Combination-BU6xJxfT.js";import"./index-BdQq_4o_.js";import"./index-KgiDK8vA.js";import"./index-B4oGC8tk.js";import"./index-DC5Tape7.js";import"./index-DkFGe9Gh.js";const sa=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],na=ue("CalendarCheck",sa);const ra=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m14 14-4 4",key:"rymu2i"}],["path",{d:"m10 14 4 4",key:"3sz06r"}]],la=ue("CalendarX",ra);function ia({calendars:a}){const l=a.length,s=a.filter(h=>h.status==="active").length,p=a.filter(h=>h.status==="inactive").length,r=[{label:"Total Calendars",value:l,icon:te,color:"text-primary",note:null},{label:"Active",value:s,icon:na,color:"text-green-500",note:null},{label:"Inactive",value:p,icon:la,color:"text-amber-500",note:"Redirects to contact page"}];return e.jsx("div",{className:"grid grid-cols-3 gap-4",children:r.map(h=>e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h.icon,{className:`h-5 w-5 ${h.color}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:h.label}),h.note&&e.jsx("p",{className:"text-[10px] text-muted-foreground/70 mt-0.5",children:h.note})]})]})},h.label))})}const ca=[{value:"individual",label:"Individual"},{value:"interview",label:"Interview"},{value:"partnership",label:"Partnership"},{value:"podcast",label:"Podcast"},{value:"shared",label:"Shared"}],oa=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],da=a=>{switch(a){case"active":return"default";case"inactive":return"secondary";case"archived":return"outline";default:return"secondary"}},ua=a=>{switch(a){case"individual":return"default";case"interview":return"secondary";case"partnership":return"outline";case"podcast":return"destructive";case"shared":return"default";default:return"secondary"}},ee={calendar_name:{key:"calendar_name",label:"Calendar Name",sortable:!0,width:200},site_location:{key:"site_location",label:"Website Location",sortable:!0,width:150,editable:!0,render:(a,l)=>e.jsx(g,{defaultValue:a.site_location||"",className:"h-8 text-sm",onBlur:s=>{s.target.value!==(a.site_location||"")&&l(a.id,"site_location",s.target.value)},onKeyDown:s=>{s.key==="Enter"&&s.target.blur()}})},participants:{key:"participants",label:"Participants",sortable:!0,width:150,editable:!0,render:(a,l)=>e.jsx(g,{defaultValue:a.participants||"",className:"h-8 text-sm",onBlur:s=>{s.target.value!==(a.participants||"")&&l(a.id,"participants",s.target.value)},onKeyDown:s=>{s.key==="Enter"&&s.target.blur()}})},owner:{key:"owner",label:"Owner",sortable:!0,width:120,editable:!0,render:(a,l)=>e.jsx(g,{defaultValue:a.owner||"",className:"h-8 text-sm",onBlur:s=>{s.target.value!==(a.owner||"")&&l(a.id,"owner",s.target.value)},onKeyDown:s=>{s.key==="Enter"&&s.target.blur()}})},calendar_type:{key:"calendar_type",label:"Type",sortable:!0,width:130,editable:!0,centered:!0,render:(a,l)=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(A,{defaultValue:a.calendar_type,onValueChange:s=>l(a.id,"calendar_type",s),children:[e.jsx(O,{className:"h-8 text-sm w-[120px]",children:e.jsx(R,{})}),e.jsx(I,{children:ca.map(s=>e.jsx(f,{value:s.value,children:e.jsx(se,{variant:ua(s.value),className:"text-xs",children:s.label})},s.value))})]})})},status:{key:"status",label:"Status",sortable:!0,width:120,editable:!0,centered:!0,render:(a,l)=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(A,{defaultValue:a.status,onValueChange:s=>l(a.id,"status",s),children:[e.jsx(O,{className:"h-8 text-sm w-[110px]",children:e.jsx(R,{})}),e.jsx(I,{children:oa.map(s=>e.jsx(f,{value:s.value,children:e.jsx(se,{variant:da(s.value),className:"text-xs",children:s.label})},s.value))})]})})},public_url:{key:"public_url",label:"Public URL",sortable:!1,width:180},actions:{key:"actions",label:"Actions",sortable:!1,width:120,centered:!0}},ha=["calendar_name","site_location","participants","calendar_type","status","public_url","actions"];function ma({calendars:a,loading:l,sortColumn:s,sortDirection:p,onSort:r,onCalendarClick:h,onUpdate:j,onDelete:C,visibleColumns:i=ha,columnWidths:v={},onColumnWidthChange:d}){const[S,n]=m.useState(null),F=m.useRef(0),P=m.useRef(0),[U,D]=m.useState(null),t=o=>v[o]||ee[o]?.width||150,T=m.useCallback((o,u)=>{o.preventDefault(),n(u),F.current=o.clientX,P.current=t(u);const b=L=>{const J=L.clientX-F.current,W=Math.max(80,P.current+J);d?.(u,W)},k=()=>{n(null),document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",k)},[d]),E=o=>`https://cynergists.ai/${o}`,Y=async o=>{const u=E(o.slug);await navigator.clipboard.writeText(u),D(o.id),w.success("Link copied to clipboard"),setTimeout(()=>D(null),2e3)},q=({column:o})=>s!==o?null:p==="asc"?e.jsx(qe,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"});return l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):a.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:e.jsx("p",{children:"No calendars found"})}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-border bg-muted/50",children:i.map((o,u)=>{const b=ee[o];if(!b)return null;const k=u===0;return e.jsxs("th",{className:`relative px-4 py-3 text-sm font-medium text-muted-foreground whitespace-nowrap ${k?"sticky left-0 z-30 bg-muted/50 text-left":"sticky top-0 z-20"} ${b.centered?"text-center":"text-left"} ${b.sortable?"cursor-pointer hover:text-foreground":""}`,style:{width:t(o),minWidth:t(o)},onClick:L=>{b.sortable&&(L.preventDefault(),L.stopPropagation(),r(o))},children:[e.jsxs("div",{className:`flex items-center gap-1 ${b.centered?"justify-center":""}`,children:[b.label,b.sortable&&e.jsx(q,{column:o})]}),e.jsx("div",{className:"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-primary/50",onMouseDown:L=>T(L,o)})]},o)})})}),e.jsx("tbody",{children:a.map(o=>e.jsx("tr",{className:"border-b border-border hover:bg-muted/30",children:i.map((u,b)=>{const k=ee[u];if(!k)return null;if(u==="calendar_name")return e.jsx("td",{className:"sticky left-0 z-10 bg-background px-4 py-3 text-sm font-medium",style:{width:t(u),minWidth:t(u)},children:e.jsx("button",{onClick:()=>h(o),className:"text-left text-lime-400 hover:text-lime-300 hover:underline transition-colors",children:o.calendar_name})},u);if(u==="public_url")return e.jsx("td",{className:"px-4 py-3 text-sm",style:{width:t(u),minWidth:t(u)},children:e.jsxs("span",{className:"truncate max-w-[140px] text-muted-foreground text-xs font-mono",children:["cynergists.com/",o.slug]})},u);if(u==="actions"){const L=E(o.slug);return e.jsx("td",{className:"px-4 py-3 text-sm",style:{width:t(u),minWidth:t(u)},children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Y(o),children:U===o.id?e.jsx(pe,{className:"h-4 w-4 text-green-500"}):e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7",asChild:!0,children:e.jsx("a",{href:L,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ve,{className:"h-4 w-4"})})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-destructive",onClick:()=>C?.(o.id),children:e.jsx(he,{className:"h-4 w-4"})})]})},u)}return k.render?e.jsx("td",{className:"px-4 py-3 text-sm",style:{width:t(u),minWidth:t(u)},children:k.render(o,j)},u):e.jsx("td",{className:"px-4 py-3 text-sm",style:{width:t(u),minWidth:t(u)},children:String(o[u]??"")},u)})},o.id))})]})})}const xa=["Get Unstuck Fast","Get Clarity and a Real Plan","You're the Right Fit","the Right Fit","Light the Signal","Guest Recording","Scaling Up Success","Pre Show","Almost On","Get Clarity","Get Unstuck","Real Plan","Right Fit","Your Heroes","Team of Heroes","Leave the Heavy Lifting to Us","Lead Like a Hero","Heroes","Hero","Clarity","Unstuck","Support","Victory","Freedom","Mission","Elite","Success"];function je(a){if(!a||a.includes("<span"))return a;const l=[...xa].sort((s,p)=>p.length-s.length);for(const s of l){const p=new RegExp(`(${s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");if(p.test(a))return a.replace(p,'<span class="text-gradient">$1</span>')}return a}function pa(a){return a&&a.replace(/<span class="text-gradient">([^<]+)<\/span>/g,"$1")}const ga=[{value:"individual",label:"Individual"},{value:"shared",label:"Shared"}],va=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],Q="Growth should not depend on heroics. Cynergists helps your team move faster, stay aligned, and get more done without the constant friction. No pitch. Just a quick chat to see if you are a fit.";function ja({calendar:a,open:l,onClose:s,onSave:p,onUpdate:r,onDelete:h}){const[j,C]=m.useState(!1),[i,v]=m.useState({calendar_name:"",site_location:"",participants:"",calendar_type:"individual",status:"active",slug:"",owner:"",headline:"",paragraph:Q,ghl_calendar_id:"",ghl_embed_code:"",internal_notes:""});m.useEffect(()=>{v(a?{calendar_name:a.calendar_name,site_location:a.site_location||"",participants:a.participants||"",calendar_type:a.calendar_type,status:a.status,slug:a.slug,owner:a.owner||"",headline:pa(a.headline||""),paragraph:a.paragraph||Q,ghl_calendar_id:a.ghl_calendar_id||"",ghl_embed_code:a.ghl_embed_code||"",internal_notes:a.internal_notes||""}:{calendar_name:"",site_location:"",participants:"",calendar_type:"individual",status:"active",slug:"",owner:"",headline:"",paragraph:Q,ghl_calendar_id:"",ghl_embed_code:"",internal_notes:""})},[a]);const d=(t,T)=>{v(E=>({...E,[t]:T}))},S=m.useMemo(()=>a?{calendar_name:a.calendar_name,site_location:a.site_location||"",participants:a.participants||"",calendar_type:a.calendar_type,status:a.status,slug:a.slug,owner:a.owner||"",headline:a.headline||"",paragraph:a.paragraph||Q,ghl_calendar_id:a.ghl_calendar_id||"",ghl_embed_code:a.ghl_embed_code||"",internal_notes:a.internal_notes||""}:null,[a]),n=m.useCallback(async t=>{if(!a||!r||!t.calendar_name||!t.slug)return!1;try{const T={...t,headline:t.headline?je(t.headline):t.headline};return r(a.id,T),!0}catch{return!1}},[a,r]),{isSaving:F}=Xe({data:i,onSave:n,enabled:!!a&&l,initialData:S}),P=()=>{a&&h&&(h(a.id),s())},U=async()=>{const t=`https://cynergists.ai/${i.slug}`;await navigator.clipboard.writeText(t),C(!0),w.success("Link copied to clipboard"),setTimeout(()=>C(!1),2e3)},D=`https://cynergists.ai/${i.slug}`;return e.jsx(We,{open:l,onOpenChange:s,children:e.jsxs(Ve,{className:"w-full sm:max-w-lg overflow-y-auto",children:[e.jsx(Be,{children:e.jsxs(Qe,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),a?"Edit Calendar":"New Calendar"]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2 text-muted-foreground",children:[e.jsx(te,{className:"h-4 w-4"}),"Calendar Details"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"calendar_name",children:"Calendar Name *"}),e.jsx(g,{id:"calendar_name",value:i.calendar_name,onChange:t=>d("calendar_name",t.target.value),placeholder:"e.g., Ryan's Strategy Call"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"site_location",children:"Website Location"}),e.jsx(g,{id:"site_location",value:i.site_location,onChange:t=>d("site_location",t.target.value),placeholder:"e.g., Colorado Springs, CO"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"participants",children:"Participants"}),e.jsx(g,{id:"participants",value:i.participants,onChange:t=>d("participants",t.target.value),placeholder:"e.g., Ryan + Chris"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"calendar_type",children:"Calendar Type"}),e.jsx("div",{className:"flex gap-2 mt-1.5",children:ga.map(t=>e.jsx("button",{type:"button",onClick:()=>d("calendar_type",t.value),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i.calendar_type===t.value?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"status",children:"Status"}),e.jsxs(A,{value:i.status,onValueChange:t=>d("status",t),children:[e.jsx(O,{children:e.jsx(R,{})}),e.jsx(I,{children:va.map(t=>e.jsx(f,{value:t.value,children:e.jsx(se,{variant:t.value==="active"?"default":"secondary",children:t.label})},t.value))})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"slug",children:"Slug *"}),e.jsx(g,{id:"slug",value:i.slug,onChange:t=>d("slug",t.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")),placeholder:"e.g., meetryan",className:"font-mono"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Changing the slug will change the public URL"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"owner",children:"Owner"}),e.jsx(g,{id:"owner",value:i.owner,onChange:t=>d("owner",t.target.value),placeholder:"e.g., Ryan"})]}),e.jsxs("div",{children:[e.jsx(x,{children:"Public URL"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(g,{value:D,readOnly:!0,className:"font-mono text-sm bg-muted"}),e.jsx(_,{variant:"outline",size:"icon",onClick:U,children:j?e.jsx(pe,{className:"h-4 w-4 text-green-500"}):e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"icon",asChild:!0,children:e.jsx("a",{href:D,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ve,{className:"h-4 w-4"})})})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"headline",children:"Headline"}),e.jsx(g,{id:"headline",value:i.headline,onChange:t=>d("headline",t.target.value),placeholder:"e.g., Lead Like a Hero, Leave the Heavy Lifting to Us"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"paragraph",children:"Paragraph"}),e.jsx($,{id:"paragraph",value:i.paragraph,onChange:t=>d("paragraph",t.target.value),placeholder:"Enter landing page paragraph...",rows:4})]})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2 text-muted-foreground",children:[e.jsx(Pe,{className:"h-4 w-4"}),"GHL Configuration"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"ghl_calendar_id",children:"GHL Calendar ID"}),e.jsx(g,{id:"ghl_calendar_id",value:i.ghl_calendar_id,onChange:t=>d("ghl_calendar_id",t.target.value),placeholder:"Enter GHL Calendar ID",className:"font-mono"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"ghl_embed_code",children:"GHL Embed Code"}),e.jsx($,{id:"ghl_embed_code",value:i.ghl_embed_code,onChange:t=>d("ghl_embed_code",t.target.value),placeholder:"Paste your GHL calendar embed code here...",rows:6,className:"font-mono text-xs"})]})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ye,{className:"h-4 w-4"}),"Notes"]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"internal_notes",children:"Internal Notes"}),e.jsx($,{id:"internal_notes",value:i.internal_notes,onChange:t=>d("internal_notes",t.target.value),placeholder:"Internal notes...",rows:3})]})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"System Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Created"}),e.jsx("p",{children:ce(new Date(a.created_at),"MMM d, yyyy")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Last Updated"}),e.jsx("p",{children:ce(new Date(a.updated_at),"MMM d, yyyy")})]})]})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&h&&e.jsxs(_,{variant:"destructive",className:"flex-1",onClick:P,children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Delete",F&&e.jsx(me,{className:"h-3 w-3 ml-2 animate-spin"})]}),e.jsx(_,{variant:"outline",className:"flex-1",onClick:s,children:"Close"})]})]})]})})}function fa(a={}){const{search:l="",sortColumn:s="calendar_name",sortDirection:p="asc",page:r=1,pageSize:h=50,filters:j={}}=a;return xe({queryKey:["calendars",{search:l,sortColumn:s,sortDirection:p,page:r,pageSize:h,filters:j}],queryFn:async()=>G("get_calendars",void 0,{search:l,sortColumn:s,sortDirection:p,page:r,pageSize:h,filters:j})})}function _a(){const a=X();return z({mutationFn:async l=>G("create_calendar",void 0,l),onSuccess:()=>{a.invalidateQueries({queryKey:["calendars"]}),w.success("Calendar created successfully")},onError:l=>{w.error(l.message||"Failed to create calendar")}})}function ya(){const a=X();return z({mutationFn:async({id:l,...s})=>G("update_calendar",{id:l},s),onSuccess:()=>{a.invalidateQueries({queryKey:["calendars"]}),w.success("Calendar updated successfully")},onError:l=>{w.error(l.message||"Failed to update calendar")}})}function Ca(){const a=X();return z({mutationFn:async l=>G("delete_calendar",{id:l}),onSuccess:()=>{a.invalidateQueries({queryKey:["calendars"]}),w.success("Calendar deleted successfully")},onError:l=>{w.error(l.message||"Failed to delete calendar")}})}function ba(){return z({mutationFn:async({slug:a,excludeId:l})=>G("check_calendar_slug",void 0,{slug:a,excludeId:l})})}const Na=[{value:"individual",label:"Individual"},{value:"shared",label:"Shared"}];function wa({open:a,onClose:l,onSubmit:s}){const p=ba(),[r,h]=m.useState({first_name:"",last_name:"",calendar_name:"",calendar_type:"individual",site_location:"",participants:"",slug:"",headline:"Lead Like a Hero, Leave the Heavy Lifting to Us",paragraph:"Growth should not depend on heroics. Cynergists helps your team move faster, stay aligned, and get more done without the constant friction. No pitch. Just a quick chat to see if you are a fit.",ghl_embed_code:""}),[j,C]=m.useState(null),i=(n,F)=>{h(P=>({...P,[n]:F})),n==="slug"&&C(null)},v=async()=>{if(r.slug)try{(await p.mutateAsync({slug:r.slug})).isUnique||C("This slug is already in use")}catch(n){console.error("Error checking slug:",n)}},d=()=>{if(!r.calendar_name){w.error("Calendar name is required");return}if(!r.slug){w.error("Slug is required");return}if(j){w.error("Please fix the slug error");return}const n={calendar_name:r.calendar_name,owner:`${r.first_name} ${r.last_name}`.trim(),calendar_type:r.calendar_type,site_location:r.site_location||void 0,participants:r.participants||void 0,slug:r.slug,status:"active",ghl_embed_code:r.ghl_embed_code,headline:r.headline?je(r.headline):void 0,paragraph:r.paragraph||void 0};s(n),S()},S=()=>{h({first_name:"",last_name:"",calendar_name:"",calendar_type:"individual",site_location:"",participants:"",slug:"",headline:"Lead Like a Hero, Leave the Heavy Lifting to Us",paragraph:"Growth should not depend on heroics. Cynergists helps your team move faster, stay aligned, and get more done without the constant friction. No pitch. Just a quick chat to see if you are a fit.",ghl_embed_code:""}),C(null),l()};return e.jsx(Je,{open:a,onOpenChange:S,children:e.jsxs(Ze,{className:"sm:max-w-2xl",children:[e.jsx(Ke,{children:e.jsx(ea,{children:"Create New Calendar"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"calendar_name",children:"Calendar Name *"}),e.jsx(g,{id:"calendar_name",value:r.calendar_name,onChange:n=>i("calendar_name",n.target.value),placeholder:"e.g., Strategy Call with Ryan"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"calendar_type",children:"Calendar Type"}),e.jsx("div",{className:"flex gap-2 mt-1.5",children:Na.map(n=>e.jsx("button",{type:"button",onClick:()=>i("calendar_type",n.value),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${r.calendar_type===n.value?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:n.label},n.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"first_name",children:"Owner First Name"}),e.jsx(g,{id:"first_name",value:r.first_name,onChange:n=>i("first_name",n.target.value),placeholder:"First name"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"last_name",children:"Owner Last Name"}),e.jsx(g,{id:"last_name",value:r.last_name,onChange:n=>i("last_name",n.target.value),placeholder:"Last name"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"site_location",children:"Site Location"}),e.jsx(g,{id:"site_location",value:r.site_location,onChange:n=>i("site_location",n.target.value),placeholder:"e.g., Header, Footer, Contact Page"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"participants",children:"Participants"}),e.jsx(g,{id:"participants",value:r.participants,onChange:n=>i("participants",n.target.value),placeholder:"e.g., Ryan, Chris"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"slug",children:"Slug *"}),e.jsx(g,{id:"slug",value:r.slug,onChange:n=>i("slug",n.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")),onBlur:v,placeholder:"e.g., meetryan",className:`font-mono ${j?"border-destructive":""}`}),j&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:j}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["URL: https://cynergists.ai/",r.slug||"your-slug"]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"headline",children:"Headline"}),e.jsx(g,{id:"headline",value:r.headline,onChange:n=>i("headline",n.target.value),placeholder:"Lead Like a Hero, Leave the Heavy Lifting to Us"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"paragraph",children:"Paragraph"}),e.jsx($,{id:"paragraph",value:r.paragraph,onChange:n=>i("paragraph",n.target.value),placeholder:"Growth should not depend on heroics...",rows:3})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"ghl_embed_code",children:"GHL Embed Code"}),e.jsx($,{id:"ghl_embed_code",value:r.ghl_embed_code,onChange:n=>i("ghl_embed_code",n.target.value),placeholder:"Paste your GHL calendar embed code here...",rows:4,className:"font-mono text-xs"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(_,{variant:"outline",onClick:S,children:"Cancel"}),e.jsx(_,{onClick:d,children:"Create Calendar"})]})]})})}const de=["calendar_name","site_location","participants","calendar_type","status","public_url","actions"],ae={calendar_name:200,site_location:150,participants:150,calendar_type:130,status:120,public_url:180,actions:120};function Sa(){const a=X(),[l,s]=m.useState(ae),p=aa(l,500),{data:r,isLoading:h}=xe({queryKey:["calendar-view-preferences"],queryFn:async()=>oe.get("/api/view-preferences/calendar_view_preferences")});m.useEffect(()=>{if(r?.column_widths){const d=r.column_widths;s({...ae,...d})}},[r]);const j=z({mutationFn:async d=>{await oe.post("/api/view-preferences/calendar_view_preferences",{column_widths:d.column_widths,column_order:d.column_order||de})},onSuccess:()=>{a.invalidateQueries({queryKey:["calendar-view-preferences"]})}});m.useEffect(()=>{!h&&p!==ae&&j.mutate({column_widths:p})},[p,h]);const C=m.useCallback((d,S)=>{s(n=>({...n,[d]:S}))},[]),i=r?.column_order||de,v=r?.hidden_columns||[];return{columnOrder:i,hiddenColumns:v,visibleColumns:i.filter(d=>!v.includes(d)),columnWidths:l,setColumnWidth:C,isLoading:h}}function st(){const[a,l]=m.useState(""),[s,p]=m.useState(""),[r,h]=m.useState("calendar_name"),[j,C]=m.useState("asc"),[i,v]=m.useState(1),[d,S]=m.useState(50),[n,F]=m.useState({}),[P,U]=m.useState(!1),[D,t]=m.useState(null),[T,E]=m.useState(!1),[Y,q]=m.useState(!1),{columnWidths:o,setColumnWidth:u,visibleColumns:b,isLoading:k}=Sa(),L=c=>{l(c);const y=setTimeout(()=>{p(c),v(1)},300);return()=>clearTimeout(y)},J={...n.status&&n.status!=="all"&&{status:n.status},...n.calendar_type&&n.calendar_type!=="all"&&{calendar_type:n.calendar_type}},{data:W,isLoading:fe}=fa({search:s,sortColumn:r,sortDirection:j,page:i,pageSize:d,filters:J}),_e=_a(),ne=ya(),ye=Ca(),re=W?.calendars||[],H=W?.total||0,M=Math.ceil(H/d),Ce=c=>{r===c?C(j==="asc"?"desc":"asc"):(h(c),C("asc"))},be=c=>{t(c),E(!0)},Ne=(c,y,N)=>{ne.mutate({id:c,[y]:N})},we=c=>{_e.mutate(c)},Se=(c,y)=>{ne.mutate({id:c,...y})},le=c=>{confirm("Are you sure you want to delete this calendar?")&&ye.mutate(c)},Z=(c,y)=>{F(N=>{if(!y||y==="all"){const{[c]:ka,...Le}=N;return Le}return{...N,[c]:y}}),v(1)},ie=()=>{F({}),v(1)},ke=c=>{S(parseInt(c)),v(1)},V=Object.keys(n).length;return k?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(me,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx(De,{children:e.jsx("title",{children:"Calendars | Admin"})}),e.jsxs("div",{className:"flex flex-col h-[calc(100vh-64px)] overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-6 pb-4 space-y-4 bg-background",children:[e.jsx(ia,{calendars:re}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Calendars"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[H," total calendars"]})]}),e.jsx("div",{className:"flex items-center gap-1 border-l pl-6",children:e.jsx(_,{variant:"secondary",size:"sm",className:"text-sm",children:"All"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search calendars...",value:a,onChange:c=>L(c.target.value),className:"pl-9 w-64"})]}),e.jsxs(Oe,{open:P,onOpenChange:U,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"relative",children:[e.jsx(ta,{className:"h-4 w-4 mr-2"}),"Filters",V>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 rounded-full bg-primary text-primary-foreground text-xs flex items-center justify-center",children:V})]})}),e.jsx(Ie,{className:"w-80",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Filters"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Status"}),e.jsxs(A,{value:n.status||"all",onValueChange:c=>Z("status",c),children:[e.jsx(O,{children:e.jsx(R,{placeholder:"All statuses"})}),e.jsxs(I,{children:[e.jsx(f,{value:"all",children:"All"}),e.jsx(f,{value:"active",children:"Active"}),e.jsx(f,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Type"}),e.jsxs(A,{value:n.calendar_type||"all",onValueChange:c=>Z("calendar_type",c),children:[e.jsx(O,{children:e.jsx(R,{placeholder:"All types"})}),e.jsxs(I,{children:[e.jsx(f,{value:"all",children:"All Types"}),e.jsx(f,{value:"individual",children:"Individual"}),e.jsx(f,{value:"interview",children:"Interview"}),e.jsx(f,{value:"partnership",children:"Partnership"}),e.jsx(f,{value:"podcast",children:"Podcast"}),e.jsx(f,{value:"shared",children:"Shared"})]})]})]}),V>0&&e.jsx(_,{variant:"ghost",size:"sm",onClick:ie,className:"w-full",children:"Clear all filters"})]})})]}),e.jsxs(_,{onClick:()=>q(!0),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Create Calendar"]})]})]}),V>0&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),Object.entries(n).map(([c,y])=>e.jsxs(_,{variant:"secondary",size:"sm",onClick:()=>Z(c,""),className:"h-6 text-xs",children:[c,": ",y,e.jsx(Ae,{className:"h-3 w-3 ml-1"})]},c)),e.jsx(_,{variant:"ghost",size:"sm",onClick:ie,className:"h-6 text-xs",children:"Clear all"})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden px-6",children:e.jsx("div",{className:"border rounded-lg h-full overflow-auto",children:e.jsx(ma,{calendars:re,loading:fe,sortColumn:r,sortDirection:j,onSort:Ce,onCalendarClick:be,onUpdate:Ne,onDelete:le,visibleColumns:b,columnWidths:o,onColumnWidthChange:u})})}),e.jsx("div",{className:"flex-shrink-0 px-6 py-4 bg-background border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Rows per page:"}),e.jsxs(A,{value:d.toString(),onValueChange:ke,children:[e.jsx(O,{className:"w-20",children:e.jsx(R,{})}),e.jsxs(I,{children:[e.jsx(f,{value:"25",children:"25"}),e.jsx(f,{value:"50",children:"50"}),e.jsx(f,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground ml-4",children:["Showing ",Math.min((i-1)*d+1,H)," -"," ",Math.min(i*d,H)," of ",H]})]}),M>1&&e.jsx(Ue,{children:e.jsxs(He,{children:[e.jsx(K,{children:e.jsx(Me,{onClick:()=>v(c=>Math.max(1,c-1)),className:i===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:Math.min(5,M)},(c,y)=>{const N=i<=3?y+1:i+y-2;return N<1||N>M?null:e.jsx(K,{children:e.jsx($e,{onClick:()=>v(N),isActive:i===N,className:"cursor-pointer",children:N})},N)}),e.jsx(K,{children:e.jsx(ze,{onClick:()=>v(c=>Math.min(M,c+1)),className:i===M?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})]}),e.jsx(ja,{calendar:D,open:T,onClose:()=>{E(!1),t(null)},onUpdate:Se,onDelete:le}),e.jsx(wa,{open:Y,onClose:()=>q(!1),onSubmit:we})]})}export{st as default};
