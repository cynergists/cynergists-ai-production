import{as as C,r as j,u as b,j as e,L as D,B as r,d as T,P as S,T as k,h as i,s as d}from"./app-C9sJHYCL.js";import{u as f}from"./useMutation-Dhp3buk0.js";import{I as E}from"./input-BIyZmrfA.js";import{L as g}from"./label-CON6LZW3.js";import{T as L}from"./textarea-Ho9uOiBu.js";import{S as M}from"./switch-CgUnYb0N.js";import{T as P,a as I,b as u,c as m,d as K,e as n}from"./table-DvSgZRYl.js";import{D as z,g as B,a as H,c as O,d as R,e as U,f as Y}from"./dialog-DAfnVAW3.js";import{P as G}from"./pencil-Z_c4sc1N.js";/* empty css            */import"./index-B3oBxWiH.js";import"./index-H_9W4N8N.js";import"./index-qTvOvuVq.js";import"./Combination-Bv4OtcuM.js";function le(){const h=C(),[y,x]=j.useState(!1),[o,w]=j.useState(null),[t,l]=j.useState({question:"",answer:"",is_active:!0}),{data:p,isLoading:A}=b({queryKey:["portal-faqs"],queryFn:async()=>{const{data:s,error:a}=await d.from("portal_faq_items").select("*").order("sort_order",{ascending:!0});if(a)throw a;return s}}),v=f({mutationFn:async s=>{const{error:a}=await d.from("portal_faq_items").insert({...s,sort_order:(p?.length||0)+1});if(a)throw a},onSuccess:()=>{h.invalidateQueries({queryKey:["portal-faqs"]}),i.success("FAQ created successfully"),c()},onError:s=>{i.error("Failed to create FAQ: "+s.message)}}),F=f({mutationFn:async({id:s,data:a})=>{const{error:q}=await d.from("portal_faq_items").update(a).eq("id",s);if(q)throw q},onSuccess:()=>{h.invalidateQueries({queryKey:["portal-faqs"]}),i.success("FAQ updated successfully"),c()},onError:s=>{i.error("Failed to update FAQ: "+s.message)}}),N=f({mutationFn:async s=>{const{error:a}=await d.from("portal_faq_items").delete().eq("id",s);if(a)throw a},onSuccess:()=>{h.invalidateQueries({queryKey:["portal-faqs"]}),i.success("FAQ deleted successfully")},onError:s=>{i.error("Failed to delete FAQ: "+s.message)}}),c=()=>{l({question:"",answer:"",is_active:!0}),w(null),x(!1)},Q=s=>{w(s),l({question:s.question,answer:s.answer,is_active:s.is_active}),x(!0)},_=s=>{s.preventDefault(),o?F.mutate({id:o.id,data:t}):v.mutate(t)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(D,{href:"/admin/client-portal",children:e.jsx(r,{variant:"ghost",size:"icon",children:e.jsx(T,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Manage FAQs"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure FAQ items for the customer support page"})]})]}),e.jsxs(z,{open:y,onOpenChange:x,children:[e.jsx(B,{asChild:!0,children:e.jsxs(r,{onClick:()=>c(),children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Add FAQ"]})}),e.jsx(H,{className:"sm:max-w-[600px]",children:e.jsxs("form",{onSubmit:_,children:[e.jsxs(O,{children:[e.jsx(R,{children:o?"Edit FAQ":"Add FAQ"}),e.jsx(U,{children:o?"Update the FAQ details":"Fill in the question and answer"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"question",children:"Question"}),e.jsx(E,{id:"question",value:t.question,onChange:s=>l({...t,question:s.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"answer",children:"Answer"}),e.jsx(L,{id:"answer",value:t.answer,onChange:s=>l({...t,answer:s.target.value}),rows:4,required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{id:"is_active",checked:t.is_active,onCheckedChange:s=>l({...t,is_active:s})}),e.jsx(g,{htmlFor:"is_active",children:"Active"})]})]}),e.jsxs(Y,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:c,children:"Cancel"}),e.jsx(r,{type:"submit",disabled:v.isPending||F.isPending,children:o?"Update":"Create"})]})]})})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(P,{children:[e.jsx(I,{children:e.jsxs(u,{children:[e.jsx(m,{className:"w-[40%]",children:"Question"}),e.jsx(m,{className:"w-[40%]",children:"Answer"}),e.jsx(m,{children:"Active"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsx(K,{children:A?e.jsx(u,{children:e.jsx(n,{colSpan:4,className:"text-center",children:"Loading..."})}):p?.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:4,className:"text-center text-muted-foreground",children:'No FAQs yet. Click "Add FAQ" to create one.'})}):p?.map(s=>e.jsxs(u,{children:[e.jsx(n,{className:"font-medium",children:s.question}),e.jsx(n,{className:"text-muted-foreground truncate max-w-xs",children:s.answer}),e.jsx(n,{children:s.is_active?"Yes":"No"}),e.jsxs(n,{className:"text-right",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>Q(s),children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>{confirm("Are you sure you want to delete this FAQ?")&&N.mutate(s.id)},children:e.jsx(k,{className:"h-4 w-4"})})]})]},s.id))})]})})]})}export{le as default};
