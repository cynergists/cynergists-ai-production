import{l as fe,r as a,j as e,B as b,m as H,n as U,o as _e,p as Me,h as A,q as Le,g as Oe,t as Be,C as xe,F as $e,i as Re,H as ze,L as Ue,d as Ye,S as De}from"./app-C9sJHYCL.js";import{I as j}from"./input-BIyZmrfA.js";import{L as N}from"./label-CON6LZW3.js";import{u as Ve}from"./usePaymentSettings-D0urzAO_.js";import{U as Je}from"./user-KPGr3U8Z.js";import{C as pe}from"./circle-check-60y6qqHP.js";import{C as K}from"./credit-card-D5-dRmjT.js";import{C as We}from"./check-BybgecC6.js";import{R as He}from"./receipt-Kn0ghxkp.js";import{C as Ke}from"./copy-mSe4nMDe.js";import{B as Ge}from"./building-BfcKhh8J.js";import{L as Qe}from"./Layout-Dnedcct2.js";/* empty css            */import"./index-B3oBxWiH.js";import"./Footer-D1lC2Wf3.js";import"./sparkles-Y7NwzGaj.js";import"./shield-C_xf2SUB.js";import"./sun-Cf3Q8wZI.js";import"./phone-B-kOTN5P.js";import"./eye-B3-dt3tC.js";import"./zap-DQolQhLF.js";import"./scroll-area-C84zghn6.js";import"./index-mEKJzlVy.js";import"./index-BdQq_4o_.js";import"./purify.es-HRjpPm7y.js";import"./eye-off-DqxFK8PI.js";import"./mic-BL0akK9l.js";import"./send-CAL3Q9oR.js";const W=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),Xe=t=>{const x=t.replace(/\D/g,"").match(/.{1,4}/g);return x?x.join(" ").slice(0,19):""},Ze=t=>{const n=t.replace(/\D/g,"");return n.length>=2?`${n.slice(0,2)}/${n.slice(2,4)}`:n},es=()=>`${Date.now()}-${Math.random().toString(36).substring(2,15)}`,he=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),ss=({onNext:t,onTransactionComplete:n})=>{const{items:x,clearCart:v}=fe(),{settings:_}=Ve(),c=a.useRef(null),[d,m]=a.useState("checking"),[p,q]=a.useState(""),[o,S]=a.useState(""),[h,$]=a.useState(""),[k,g]=a.useState(""),[f,ye]=a.useState(""),[G,Q]=a.useState(!1),[X,Z]=a.useState(!1),[M,ee]=a.useState(null),[u,F]=a.useState({}),[se,te]=a.useState(!1),[R,je]=a.useState(!1),[P,re]=a.useState(null),[L,Ne]=a.useState(null),[O,be]=a.useState(null),[ae,ne]=a.useState(!1),[ie,B]=a.useState(null),[oe,ve]=a.useState(""),[ce,we]=a.useState(""),[le,Ce]=a.useState(""),[D,V]=a.useState(""),y=_.paymentMode==="production",de=x.filter(s=>s.billingPeriod==="monthly"),me=x.filter(s=>s.billingPeriod==="annual"),Se=de.reduce((s,r)=>s+r.price*r.quantity,0),z=me.reduce((s,r)=>s+r.price*12*r.quantity,0)+Se,J=me.length>0,Pe=de.length>0,ue=J&&Pe,Ie=x.map(s=>`${s.name}${s.quantity>1?` x${s.quantity}`:""}`).join(", ");a.useEffect(()=>{(async()=>{try{const r=await fetch("/api/user",{credentials:"include",headers:{Accept:"application/json"}});if(r.ok){const i=await r.json();i?(ee({name:i.name,email:i.email}),q(i.email),m("logged_in"),V(i.name||"")):m("enter_email")}else m("enter_email")}catch{m("enter_email")}})()},[]),a.useEffect(()=>{if(y&&!R){const s=document.createElement("script");return s.src="https://web.squarecdn.com/v1/square.js",s.async=!0,s.onload=()=>je(!0),document.body.appendChild(s),()=>{document.body.contains(s)&&document.body.removeChild(s)}}},[y,R]),a.useEffect(()=>{y&&(!L||!O)&&fetch("/api/payment/config",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then(s=>s.json()).then(s=>{s.locationId&&Ne(s.locationId),s.applicationId&&be(s.applicationId),s.error&&B(s.error)}).catch(s=>{console.error("Failed to fetch Square config:",s),B("Failed to connect to payment service")})},[y,L,O]),a.useEffect(()=>{let s=!0,r=null;const i=async()=>{if(!y||!R||!window.Square||!L||!O)return;if(!document.getElementById("square-card-container")){setTimeout(()=>{s&&i()},100);return}ne(!0),B(null);try{if(P){try{P.destroy()}catch(Ae){console.warn("Error destroying previous Square card:",Ae)}re(null)}const C=await window.Square.payments(O,L);if(!s)return;const E={input:{backgroundColor:"transparent",color:"hsl(var(--foreground))",fontFamily:"inherit",fontSize:"14px"},"input::placeholder":{color:"hsl(var(--muted-foreground))"},".input-container":{borderColor:"hsl(var(--border))",borderWidth:"1px",borderRadius:"6px"},".input-container.is-focus":{borderColor:"hsl(var(--primary))"},".input-container.is-error":{borderColor:"hsl(var(--destructive))"}},l=await C.card({style:E});if(!s){l.destroy();return}if(r=l,!document.getElementById("square-card-container")){l.destroy();return}if(await l.attach("#square-card-container"),!s){l.destroy();return}re(l),B(null)}catch(C){console.error("Failed to initialize Square card:",C),s&&B(C instanceof Error?C.message:"Failed to initialize payment")}finally{s&&ne(!1)}},w=setTimeout(i,50);return()=>{if(s=!1,clearTimeout(w),r)try{r.destroy()}catch(I){console.warn("Error destroying Square card on cleanup:",I)}}},[y,R,L,O]),a.useEffect(()=>{c.current=P},[P]),a.useEffect(()=>()=>{if(c.current)try{c.current.destroy()}catch(s){console.warn("Error destroying Square card on unmount:",s)}},[]);const qe=async()=>{if(!he(p)){F({email:"Please enter a valid email address"});return}Q(!0),F({});try{(await(await fetch("/api/checkout/check-email",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({email:p})})).json()).exists?m("existing_user"):m("new_user")}catch(s){console.error("Error checking email:",s),A.error("Failed to check email. Please try again.")}finally{Q(!1)}},ke=async()=>{const s={};if(o.trim()||(s.firstName="First name is required"),h.trim()||(s.lastName="Last name is required"),he(p)||(s.email="Valid email is required"),k.length<8&&(s.password="Password must be at least 8 characters"),k!==f&&(s.confirmPassword="Passwords do not match"),Object.keys(s).length>0){F(s);return}Z(!0),F({});try{const r=await fetch("/api/checkout/register",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({first_name:o,last_name:h,email:p,password:k,password_confirmation:f})}),i=await r.json();if(r.ok&&i.success)ee({name:i.user.name,email:i.user.email}),V(`${o} ${h}`),m("logged_in"),A.success("Account created successfully!");else if(i.errors){const w={};Object.keys(i.errors).forEach(I=>{w[I]=i.errors[I][0]}),F(w)}else A.error(i.message||"Failed to create account")}catch(r){console.error("Error registering:",r),A.error("Failed to create account. Please try again.")}finally{Z(!1)}},Fe=async s=>{s.preventDefault(),te(!0);try{let r;if(y){if(!P)throw new Error("Payment form not properly initialized. Please refresh and try again.");const l=await P.tokenize();if(l.status!=="OK"||!l.token)throw new Error(l.errors?.[0]?.message||"Card tokenization failed.");r=l.token}else r="cnon:card-nonce-ok";const i=x.map(l=>({name:l.name,description:l.description,quantity:l.quantity,price:Math.round(l.price*100)})),w=M?.email||p,I=M?.name||`${o} ${h}`.trim()||D,C=await fetch("/api/payment/process",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({source_id:r,amount:Math.round(z*100),currency:"USD",customer_email:w,customer_name:I,idempotency_key:es(),order_description:Ie||"Custom Order",cart_items:i})}),E=await C.json();if(!C.ok)throw new Error(E.error||"Payment processing failed");if(E.success){const l={subscriptionId:E.payment_id,customerId:void 0,amountPaid:z,processingFee:0,paymentMethod:"credit_card",billingPeriod:ue?"mixed":J?"annual":"monthly",paidAt:new Date,cartItems:x.map(T=>({name:T.name,description:T.description,quantity:T.quantity,price:T.price,billingPeriod:T.billingPeriod}))};n(l),v(),A.success("Payment successful!"),t()}else throw new Error(E.error||"Payment failed")}catch(r){const i=r instanceof Error?r.message:"Payment failed. Please try again.";A.error(i)}finally{te(!1)}},Ee=y?P!==null&&!ae:(()=>{const s=oe.replace(/\s/g,""),r=ce.split("/");return s.length===16&&r.length===2&&r[0].length===2&&r[1].length===2&&le.length>=3&&D.trim().length>0})(),Te=(d==="logged_in"||d==="existing_user")&&Ee&&!se;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-glass p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Je,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:d==="logged_in"?"You're signed in":"Enter your email to continue"})]})]}),d==="logged_in"&&M&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-primary/5 border border-primary/20 rounded-lg",children:[e.jsx(pe,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:M.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:M.email})]})]}),d==="existing_user"&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-primary/5 border border-primary/20 rounded-lg",children:[e.jsx(pe,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:"Welcome back!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p})]}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",className:"text-xs",onClick:()=>m("enter_email"),children:"Change"})]}),(d==="enter_email"||d==="checking")&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(N,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-muted-foreground"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{id:"email",type:"email",value:p,onChange:s=>{q(s.target.value),F({})},placeholder:"you@example.com",className:u.email?"border-destructive":""}),e.jsx(b,{type:"button",onClick:qe,disabled:G||!p,children:G?e.jsx(U,{className:"h-4 w-4 animate-spin"}):"Continue"})]}),u.email&&e.jsx("p",{className:"text-sm text-destructive",children:u.email})]})}),d==="new_user"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-primary/5 border border-primary/20 rounded-lg",children:[e.jsx(H,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm text-foreground",children:p}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",className:"ml-auto text-xs",onClick:()=>m("enter_email"),children:"Change"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"firstName",children:"First Name"}),e.jsx(j,{id:"firstName",value:o,onChange:s=>S(s.target.value),placeholder:"John",className:u.firstName?"border-destructive":""}),u.firstName&&e.jsx("p",{className:"text-sm text-destructive",children:u.firstName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"lastName",children:"Last Name"}),e.jsx(j,{id:"lastName",value:h,onChange:s=>$(s.target.value),placeholder:"Smith",className:u.lastName?"border-destructive":""}),u.lastName&&e.jsx("p",{className:"text-sm text-destructive",children:u.lastName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"password",children:"Password"}),e.jsx(j,{id:"password",type:"password",value:k,onChange:s=>g(s.target.value),placeholder:"Minimum 8 characters",className:u.password?"border-destructive":""}),u.password&&e.jsx("p",{className:"text-sm text-destructive",children:u.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(j,{id:"confirmPassword",type:"password",value:f,onChange:s=>ye(s.target.value),placeholder:"Confirm your password",className:u.confirmPassword?"border-destructive":""}),u.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive",children:u.confirmPassword})]}),e.jsx(b,{type:"button",onClick:ke,disabled:X,className:"w-full",children:X?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):"Create Account & Continue"})]})]}),(d==="logged_in"||d==="existing_user")&&e.jsxs("div",{className:"card-glass p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(K,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-bold text-foreground",children:"Payment"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your card details"})]})]}),e.jsxs("div",{className:"bg-primary/10 border border-primary/30 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"font-semibold text-foreground mb-2",children:"Your Order"}),e.jsx("div",{className:"space-y-1",children:x.map(s=>{const r=s.billingPeriod==="annual",i=r?s.price*12*s.quantity:s.price*s.quantity,w=r?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.name," ",s.quantity>1&&`x${s.quantity}`]}),e.jsxs("span",{className:"text-foreground",children:[W(i),w]})]},s.id)})})]}),e.jsxs("div",{className:"border-t border-primary/20 pt-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Due today"}),e.jsx("span",{className:"text-2xl font-bold text-primary",children:W(z)})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-right mt-1",children:ue?"Annual items paid upfront â€¢ Monthly items billed monthly":J?"Billed annually":"Billed monthly"})]})]}),e.jsxs("form",{onSubmit:Fe,className:"space-y-6",children:[y?e.jsxs("div",{className:"space-y-4",children:[ie&&e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive/30 rounded-lg text-destructive text-sm",children:ie}),ae&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(U,{className:"h-4 w-4 animate-spin"}),"Initializing payment form..."]}),e.jsx("div",{id:"square-card-container",className:"min-h-[120px] border border-border rounded-lg p-4 bg-background"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"cardName",children:"Cardholder Name"}),e.jsx(j,{id:"cardName",type:"text",value:D,onChange:s=>V(s.target.value),placeholder:"John Smith",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"cardNumber",children:"Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{id:"cardNumber",type:"text",inputMode:"numeric",value:oe,onChange:s=>ve(Xe(s.target.value)),placeholder:"4242 4242 4242 4242",maxLength:19,required:!0}),e.jsx(K,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"expiry",children:"Expiration"}),e.jsx(j,{id:"expiry",type:"text",inputMode:"numeric",value:ce,onChange:s=>we(Ze(s.target.value)),placeholder:"MM/YY",maxLength:5,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"cvv",children:"CVV"}),e.jsx(j,{id:"cvv",type:"text",inputMode:"numeric",value:le,onChange:s=>Ce(s.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"123",maxLength:4,required:!0})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-card/50 border border-border/50 rounded-lg",children:[e.jsx(_e,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Secure Payment"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your payment information is encrypted and securely processed"})]})]}),e.jsx(b,{type:"submit",className:"btn-primary w-full",disabled:!Te,children:se?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Complete Purchase - ",W(z)]})})]})]})]})},Y=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),ts=t=>new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"short"}).format(t),rs=({checkoutData:t,transactionData:n})=>{const{toast:x}=Le();t.planName.charAt(0).toUpperCase()+t.planName.slice(1);const v=(c,d)=>{navigator.clipboard.writeText(c),x({title:"Copied!",description:`${d} copied to clipboard`})},_=()=>{if(!n)return"Monthly Recurring";switch(n.billingPeriod){case"annual":return"Annual Billing";case"mixed":return"Mixed Billing (Monthly & Annual)";default:return"Monthly Recurring"}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"card-glass p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-primary/20 mb-6 animate-pulse",children:e.jsx(We,{className:"h-10 w-10 text-primary"})}),e.jsx("h2",{className:"font-display text-3xl font-bold text-foreground mb-4",children:"Payment Successful!"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Thank you for choosing Cynergists. Your subscription is now active."}),e.jsxs("div",{className:"inline-flex items-center gap-3 bg-primary/10 border border-primary/30 rounded-lg px-6 py-3",children:[e.jsx(H,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{className:"text-sm text-foreground",children:["Confirmation sent to ",e.jsx("strong",{children:t.contact.email})]})]})]}),e.jsxs("div",{className:"card-glass p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"font-display font-bold text-lg text-foreground flex items-center gap-2",children:[e.jsx(He,{className:"h-5 w-5 text-primary"}),"Transaction Receipt"]}),n?.paidAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Oe,{className:"h-4 w-4"}),ts(new Date(n.paidAt))]})]}),n?.subscriptionId&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Transaction ID"}),e.jsx("p",{className:"font-mono text-sm text-foreground",children:n.subscriptionId})]}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>v(n.subscriptionId,"Transaction ID"),children:e.jsx(Ke,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Order Items"}),n?.cartItems?.map((c,d)=>{const m=c.billingPeriod==="annual",p=m?c.price*12*c.quantity:c.price*c.quantity,q=m?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between py-2 border-b border-border last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-foreground",children:c.name}),c.quantity>1&&e.jsxs("span",{className:"text-muted-foreground ml-1",children:["x",c.quantity]}),c.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:c.description}),m&&e.jsx("span",{className:"inline-block text-xs bg-primary/20 text-primary px-2 py-0.5 rounded mt-1",children:"Annual"})]}),e.jsxs("span",{className:"text-foreground font-medium",children:[Y(p),q]})]},d)})]}),e.jsxs("div",{className:"border-t border-border pt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{className:"text-foreground",children:Y((n?.amountPaid||t.planPrice)-(n?.processingFee||0))})]}),n?.processingFee&&n.processingFee>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Processing Fee"}),e.jsx("span",{className:"text-foreground",children:Y(n.processingFee)})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-border",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Total Paid"}),e.jsx("span",{className:"text-xl font-bold text-primary",children:Y(n?.amountPaid||t.planPrice)})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Payment Method"}),e.jsx("div",{className:"flex items-center gap-2 text-foreground",children:(n?.paymentMethod||t.paymentMethod)==="ach"?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"h-4 w-4"}),"ACH Bank Transfer"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4"}),"Credit Card"]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Billing Cycle"}),e.jsx("p",{className:"text-foreground",children:_()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Customer"}),e.jsxs("p",{className:"text-foreground",children:[t.contact.firstName," ",t.contact.lastName]})]}),t.company.companyName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Company"}),e.jsx("p",{className:"text-foreground",children:t.company.companyName})]})]})]}),e.jsx("div",{className:"bg-destructive/10 border border-destructive/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Be,{className:"h-6 w-6 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display font-bold text-lg text-foreground mb-2",children:"Important: Service Activation"}),e.jsxs("p",{className:"text-foreground mb-4",children:["Your service will ",e.jsx("strong",{children:"not begin"})," until you complete your onboarding call. Scheduling your onboarding is ",e.jsx("strong",{children:"required"})," to activate your subscription."]})]})]})}),e.jsxs("div",{className:"card-glass p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(xe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-xl font-bold text-foreground",children:"Final Step: Schedule Your Onboarding Call"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This is required to start your services"})]})]}),e.jsxs("div",{className:"bg-background/50 border border-border rounded-lg p-8 min-h-[400px] flex flex-col items-center justify-center",children:[e.jsx(xe,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium text-foreground mb-2",children:"Onboarding Calendar"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center max-w-md mb-6",children:"Calendar embed will be configured here. Select a time that works best for your 30-minute onboarding call."}),e.jsxs("div",{className:"text-center text-xs text-muted-foreground bg-muted/50 rounded p-4",children:[e.jsx("p",{className:"font-medium mb-1",children:"Calendar Integration Pending"}),e.jsx("p",{children:"The calendar embed will be added once you provide the scheduling tool details."})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Can't find a time that works?"," ",e.jsx(b,{variant:"link",className:"text-primary p-0 h-auto",asChild:!0,children:e.jsx("a",{href:"mailto:support@cynergists.com",children:"Contact us directly"})})]})})]}),e.jsxs("div",{className:"card-glass p-6",children:[e.jsx("h3",{className:"font-display font-bold text-lg text-foreground mb-4",children:"What Happens Next?"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary text-primary-foreground text-sm font-bold flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Schedule Your Onboarding"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pick a time above to meet with your dedicated account manager"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground text-sm font-bold flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Complete Onboarding Call"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"We'll discuss your priorities, set up communication channels, and assign your team"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground text-sm font-bold flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Start Working Together"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your services begin immediately after onboarding is complete"})]})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs(b,{variant:"outline",onClick:()=>window.print(),className:"gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Print Receipt"]})})]})},ge=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),_s=()=>{const{items:t,totalPrice:n,totalItems:x}=fe(),[v,_]=a.useState("billing"),[c,d]=a.useState();a.useEffect(()=>{t.length===0&&v!=="confirmation"&&Re.visit("/cart")},[t.length,v]);const m=o=>{d(o)},p=()=>{_("confirmation"),window.scrollTo({top:0,behavior:"smooth"})},q={contact:{firstName:"",lastName:"",email:"",phone:""},company:{jobTitle:"",companyName:"",streetAddress:"",city:"",state:"",zip:""},signatures:{sectionInitials:{},clientSignature:"",signedAt:null},paymentMethod:"credit_card",planName:t.map(o=>o.name).join(", ")||"Custom Order",planPrice:n,billingPeriod:"monthly",transaction:c};return e.jsxs(Qe,{children:[e.jsxs(ze,{children:[e.jsx("title",{children:"Checkout | Cynergists"}),e.jsx("meta",{name:"description",content:"Complete your Cynergists subscription setup securely."}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsx("main",{className:"min-h-screen py-12 lg:py-20",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[v==="billing"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"ghost",asChild:!0,className:"mb-6",children:e.jsxs(Ue,{href:"/cart",children:[e.jsx(Ye,{className:"mr-2 h-4 w-4"}),"Back to Cart"]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"font-display text-3xl md:text-4xl font-bold text-foreground mb-4",children:"Checkout"}),e.jsxs("div",{className:"card-glass p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(De,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"Your Order"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",x," ",x===1?"item":"items",")"]})]}),e.jsx("div",{className:"space-y-2",children:t.map(o=>{const S=o.billingPeriod==="annual",h=S?o.price*12*o.quantity:o.price*o.quantity,$=S?"/yr":"/mo";return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[o.name," ",o.quantity>1&&`x${o.quantity}`,S&&e.jsx("span",{className:"text-xs ml-1 text-primary",children:"(Annual)"})]}),e.jsxs("span",{className:"font-medium",children:[ge(h),$]})]},o.id)})}),(()=>{const o=t.filter(g=>g.billingPeriod==="monthly"),S=t.filter(g=>g.billingPeriod==="annual"),h=o.reduce((g,f)=>g+f.price*f.quantity,0),k=S.reduce((g,f)=>g+f.price*12*f.quantity,0)+h;return e.jsx("div",{className:"border-t border-border mt-3 pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold",children:"Due Today"}),e.jsx("span",{className:"text-xl font-bold text-primary",children:ge(k)})]})})})()]})]}),e.jsx(ss,{onNext:p,onTransactionComplete:m})]}),v==="confirmation"&&e.jsx(rs,{checkoutData:q,transactionData:c})]})})})]})};export{_s as default};
