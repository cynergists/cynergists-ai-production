import{j as e,e as I,B as N,L as G,aA as R,q as U,r as d,G as Y,E as z,ac as B,b7 as H,Z as V,ab as $,b8 as O,R as W,m as P,H as Z,N as J,h as K,s as C}from"./app-4HzrmfBH.js";import{C as m,b as u,c as h,a as x,d as p}from"./card-Bm8wZBfx.js";import{I as Q}from"./input-CBRyo5y3.js";import{P as b}from"./password-input-dCDxNVpz.js";import{L as n}from"./label-DFO8C8uk.js";import{S as _}from"./switch-B4_yXbH4.js";import{S as X}from"./separator-Bpo6Y8CJ.js";import{S as ee,a as se,b as ae,c as re,d as S}from"./select-B8OCnYr5.js";import{i as te,j as ie}from"./useAdminQueries-6YmyMyUR.js";import{u as ne}from"./useSquareAnalytics-BtVmfbKP.js";import{E as oe}from"./external-link-D_5Gt5zw.js";import{S as le,M as ce}from"./sun-BNgaMKtE.js";import{M as de}from"./monitor-CASq9P11.js";/* empty css            */import"./eye-off-BM-bHoJe.js";import"./eye-DCWRxkv6.js";import"./index-BCi5JGFD.js";import"./index-Bs0kLRia.js";import"./index-Ci01D2px.js";import"./index-BdQq_4o_.js";import"./index-x88ZtXLl.js";import"./Combination-Qxmo0n5Z.js";import"./check-Cdb1fOfs.js";import"./chevron-up-D1ZX3dXR.js";import"./useMutation-DjMRzU9T.js";import"./admin-api-DWnMpZoN.js";function me({platform:t,icon:f,status:g,lastSync:o,detailsPath:j,onConfigure:w}){const l={connected:{label:"Connected",variant:"default",className:"bg-green-600 hover:bg-green-700"},not_configured:{label:"Not Configured",variant:"secondary",className:""},error:{label:"Error",variant:"destructive",className:""}}[g];return e.jsxs(m,{className:"hover:shadow-md transition-shadow h-full",children:[e.jsxs(u,{className:"p-4 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(f,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx(h,{className:"text-sm font-medium truncate",children:t})]}),e.jsx(I,{variant:l.variant,className:`${l.className} w-fit text-xs`,children:l.label})]}),e.jsxs(x,{className:"p-4 pt-2",children:[g==="connected"&&o&&e.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Last synced: ",o]}),e.jsx("div",{className:"flex",children:g==="connected"?e.jsx(N,{variant:"outline",size:"sm",asChild:!0,className:"w-full text-xs h-8",children:e.jsxs(G,{href:j,children:["View Details",e.jsx(oe,{className:"ml-1 h-3 w-3"})]})}):e.jsxs(N,{variant:"outline",size:"sm",className:"w-full text-xs h-8",onClick:w,children:[e.jsx(R,{className:"mr-1 h-3 w-3"}),"Configure"]})})]})]})}function Ge(){const{toast:t}=U(),{data:f,isLoading:g}=te(),o=ie(),{data:j,isLoading:w,error:y}=ne({from:new Date(Date.now()-720*60*60*1e3),to:new Date}),l=d.useMemo(()=>w?"not_configured":y?"error":j?"connected":"not_configured",[j,w,y]),M=d.useMemo(()=>[{platform:"Google Analytics",icon:Y,status:"not_configured",detailsPath:"/admin/analytics/website"},{platform:"Search Console",icon:z,status:"not_configured",detailsPath:"/admin/analytics/seo"},{platform:"YouTube",icon:B,status:"not_configured",detailsPath:"/admin/analytics/youtube"},{platform:"TikTok",icon:H,status:"not_configured",detailsPath:"/admin/analytics/tiktok"},{platform:"LinkedIn",icon:V,status:"not_configured",detailsPath:"/admin/analytics/linkedin"},{platform:"Meta",icon:$,status:"not_configured",detailsPath:"/admin/analytics/meta"},{platform:"Microsoft Clarity",icon:O,status:"not_configured",detailsPath:"/admin/analytics/clarity"},{platform:"Square Revenue",icon:W,status:l,detailsPath:"/admin/analytics/revenue"}],[l]),A=s=>{K.info(`Configure ${s} integration`)},[a,c]=d.useState({theme:"system",notification_email:"",email_on_agreement_signed:!0,email_on_plan_click:!1,email_on_new_session:!1}),[r,v]=d.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[k,E]=d.useState(!1);d.useEffect(()=>{f&&c(f)},[f]);const q=async()=>{try{await o.mutateAsync(a),F(a.theme),t({title:"Settings Saved",description:"Your settings have been updated successfully."})}catch(s){console.error("Error saving settings:",s),t({title:"Error",description:"Failed to save settings. Please try again.",variant:"destructive"})}},F=s=>{const i=document.documentElement;s==="dark"?i.classList.add("dark"):s==="light"?i.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches?i.classList.add("dark"):i.classList.remove("dark")},D=async s=>{if(s.preventDefault(),!r.currentPassword){t({title:"Error",description:"Please enter your current password.",variant:"destructive"});return}if(r.newPassword!==r.confirmPassword){t({title:"Error",description:"New passwords do not match.",variant:"destructive"});return}if(r.newPassword.length<6){t({title:"Error",description:"Password must be at least 6 characters.",variant:"destructive"});return}E(!0);try{const{data:{user:i}}=await C.auth.getUser();if(!i?.email)throw new Error("Unable to get current user");const{error:T}=await C.auth.signInWithPassword({email:i.email,password:r.currentPassword});if(T){t({title:"Error",description:"Current password is incorrect.",variant:"destructive"});return}const{error:L}=await C.auth.updateUser({password:r.newPassword});if(L)throw L;t({title:"Password Updated",description:"Your password has been changed successfully."}),v({currentPassword:"",newPassword:"",confirmPassword:""})}catch(i){console.error("Error changing password:",i),t({title:"Error",description:"Failed to change password. Please try again.",variant:"destructive"})}finally{E(!1)}};return g?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{children:e.jsx("title",{children:"Settings | Admin"})}),e.jsxs("div",{className:"p-6 space-y-6 max-w-4xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your admin console preferences"})]}),e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(h,{children:"Appearance"}),e.jsx(p,{children:"Customize how the admin console looks"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Theme"}),e.jsxs(ee,{value:a.theme,onValueChange:s=>c({...a,theme:s}),children:[e.jsx(se,{className:"w-full max-w-xs",children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(S,{value:"light",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"})," Light"]})}),e.jsx(S,{value:"dark",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"})," Dark"]})}),e.jsx(S,{value:"system",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"})," System"]})})]})]})]})})]}),e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(h,{children:"Notifications"}),e.jsx(p,{children:"Configure email notifications for events"})]}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"notification_email",children:"Notification Email"}),e.jsx(Q,{id:"notification_email",type:"email",value:a.notification_email,onChange:s=>c({...a,notification_email:s.target.value}),className:"max-w-md"})]}),e.jsx(X,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Agreement Signed"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified when a client signs an agreement"})]}),e.jsx(_,{checked:a.email_on_agreement_signed,onCheckedChange:s=>c({...a,email_on_agreement_signed:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Plan Clicked"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified when a user clicks on a pricing plan"})]}),e.jsx(_,{checked:a.email_on_plan_click,onCheckedChange:s=>c({...a,email_on_plan_click:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"New Session"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified when a new visitor session starts"})]}),e.jsx(_,{checked:a.email_on_new_session,onCheckedChange:s=>c({...a,email_on_new_session:s})})]})]}),e.jsxs(N,{onClick:q,disabled:o.isPending,children:[o.isPending&&e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}),"Save Settings"]})]})]}),e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(h,{children:"Security"}),e.jsx(p,{children:"Change your password"})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:D,className:"space-y-4 max-w-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"currentPassword",children:"Current Password"}),e.jsx(b,{id:"currentPassword",value:r.currentPassword,onChange:s=>v({...r,currentPassword:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"newPassword",children:"New Password"}),e.jsx(b,{id:"newPassword",value:r.newPassword,onChange:s=>v({...r,newPassword:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(b,{id:"confirmPassword",value:r.confirmPassword,onChange:s=>v({...r,confirmPassword:s.target.value}),required:!0})]}),e.jsxs(N,{type:"submit",disabled:k,children:[k&&e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}),"Change Password"]})]})})]}),e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Platform Connections"]}),e.jsx(p,{children:"Connect your analytics platforms to see unified data"})]}),e.jsx(x,{children:e.jsx("div",{className:"grid gap-3 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:M.map(s=>e.jsx(me,{...s,onConfigure:()=>A(s.platform)},s.platform))})})]}),e.jsxs(m,{className:"border-dashed",children:[e.jsxs(u,{children:[e.jsx(h,{children:"Cross-Platform Insights"}),e.jsx(p,{children:"Once you connect your platforms, you'll see unified analytics here including:"})]}),e.jsx(x,{children:e.jsxs("ul",{className:"grid gap-2 md:grid-cols-2 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-primary"}),"Combined traffic trends across all channels"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-primary"}),"Top performing content comparison"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-primary"}),"Audience overlap analysis"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-primary"}),"Revenue attribution by source"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-primary"}),"Engagement rate benchmarks"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-primary"}),"Exportable reports and summaries"]})]})})]})]})]})}export{Ge as default};
